{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\n\n\nimport { CellError, ErrorType } from '../../Cell';\nimport { ErrorMessage } from '../../error-message';\nimport { EmptyValue, getRawValue, isExtendedNumber, NumberType } from '../InterpreterValue';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\nexport var FinancialPlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(FinancialPlugin, _FunctionPlugin);\n\n  var _super = _createSuper(FinancialPlugin);\n\n  function FinancialPlugin() {\n    _classCallCheck(this, FinancialPlugin);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FinancialPlugin, [{\n    key: \"pmt\",\n    value: function pmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PMT'), pmtCore);\n    }\n  }, {\n    key: \"ipmt\",\n    value: function ipmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('IPMT'), ipmtCore);\n    }\n  }, {\n    key: \"ppmt\",\n    value: function ppmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PPMT'), ppmtCore);\n    }\n  }, {\n    key: \"fv\",\n    value: function fv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FV'), fvCore);\n    }\n  }, {\n    key: \"cumipmt\",\n    value: function cumipmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('CUMIPMT'), function (rate, periods, value, start, end, type) {\n        if (start > end) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EndStartPeriod);\n        }\n\n        var acc = 0;\n\n        for (var i = start; i <= end; i++) {\n          acc += ipmtCore(rate, i, periods, value, 0, type);\n        }\n\n        return acc;\n      });\n    }\n  }, {\n    key: \"cumprinc\",\n    value: function cumprinc(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('CUMPRINC'), function (rate, periods, value, start, end, type) {\n        if (start > end) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EndStartPeriod);\n        }\n\n        var acc = 0;\n\n        for (var i = start; i <= end; i++) {\n          acc += ppmtCore(rate, i, periods, value, 0, type);\n        }\n\n        return acc;\n      });\n    }\n  }, {\n    key: \"db\",\n    value: function db(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DB'), function (cost, salvage, life, period, month) {\n        if (month === 12 && period > life || period > life + 1) {\n          return new CellError(ErrorType.NUM, ErrorMessage.PeriodLong);\n        }\n\n        if (salvage >= cost) {\n          return 0;\n        }\n\n        var rate = Math.round((1 - Math.pow(salvage / cost, 1 / life)) * 1000) / 1000;\n        var initial = cost * rate * month / 12;\n\n        if (period === 1) {\n          return initial;\n        }\n\n        var total = initial;\n\n        for (var i = 0; i < period - 2; i++) {\n          total += (cost - total) * rate;\n        }\n\n        if (period === life + 1) {\n          return (cost - total) * rate * (12 - month) / 12;\n        }\n\n        return (cost - total) * rate;\n      });\n    }\n  }, {\n    key: \"ddb\",\n    value: function ddb(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DDB'), function (cost, salvage, life, period, factor) {\n        if (period > life) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var rate = factor / life;\n        var oldValue;\n\n        if (rate >= 1) {\n          rate = 1;\n\n          if (period === 1) {\n            oldValue = cost;\n          } else {\n            oldValue = 0;\n          }\n        } else {\n          oldValue = cost * Math.pow(1 - rate, period - 1);\n        }\n\n        var newValue = cost * Math.pow(1 - rate, period);\n        return Math.max(oldValue - Math.max(salvage, newValue), 0);\n      });\n    }\n  }, {\n    key: \"dollarde\",\n    value: function dollarde(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DOLLARDE'), function (dollar, fraction) {\n        if (fraction < 1) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        fraction = Math.trunc(fraction);\n\n        while (fraction > 10) {\n          fraction /= 10;\n        }\n\n        return Math.trunc(dollar) + (dollar - Math.trunc(dollar)) * 10 / fraction;\n      });\n    }\n  }, {\n    key: \"dollarfr\",\n    value: function dollarfr(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DOLLARFR'), function (dollar, fraction) {\n        if (fraction < 1) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        fraction = Math.trunc(fraction);\n\n        while (fraction > 10) {\n          fraction /= 10;\n        }\n\n        return Math.trunc(dollar) + (dollar - Math.trunc(dollar)) * fraction / 10;\n      });\n    }\n  }, {\n    key: \"effect\",\n    value: function effect(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('EFFECT'), function (rate, periods) {\n        periods = Math.trunc(periods);\n        return Math.pow(1 + rate / periods, periods) - 1;\n      });\n    }\n  }, {\n    key: \"ispmt\",\n    value: function ispmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('ISPMT'), function (rate, period, periods, value) {\n        if (periods === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return value * rate * (period / periods - 1);\n      });\n    }\n  }, {\n    key: \"nominal\",\n    value: function nominal(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('NOMINAL'), function (rate, periods) {\n        periods = Math.trunc(periods);\n        return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n      });\n    }\n  }, {\n    key: \"nper\",\n    value: function nper(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('NPER'), function (rate, payment, present, future, type) {\n        if (rate === 0) {\n          if (payment === 0) {\n            return new CellError(ErrorType.DIV_BY_ZERO);\n          }\n\n          return (-present - future) / payment;\n        }\n\n        if (type) {\n          payment *= 1 + rate;\n        }\n\n        return Math.log((payment - future * rate) / (present * rate + payment)) / Math.log(1 + rate);\n      });\n    }\n  }, {\n    key: \"rate\",\n    value: function rate(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('RATE'), function (periods, payment, present, future, type, guess) {\n        if (guess <= -1) {\n          return new CellError(ErrorType.VALUE);\n        }\n\n        var epsMax = 1e-10;\n        var iterMax = 20;\n        var rate = guess;\n        type = type ? 1 : 0;\n\n        for (var i = 0; i < iterMax; i++) {\n          if (rate <= -1) {\n            return new CellError(ErrorType.NUM);\n          }\n\n          var y = void 0;\n\n          if (Math.abs(rate) < epsMax) {\n            y = present * (1 + periods * rate) + payment * (1 + rate * type) * periods + future;\n          } else {\n            var f = Math.pow(1 + rate, periods);\n            y = present * f + payment * (1 / rate + type) * (f - 1) + future;\n          }\n\n          if (Math.abs(y) < epsMax) {\n            return rate;\n          }\n\n          var dy = void 0;\n\n          if (Math.abs(rate) < epsMax) {\n            dy = present * periods + payment * type * periods;\n          } else {\n            var _f = Math.pow(1 + rate, periods);\n\n            var df = periods * Math.pow(1 + rate, periods - 1);\n            dy = present * df + payment * (1 / rate + type) * df + payment * (-1 / (rate * rate)) * (_f - 1);\n          }\n\n          rate -= y / dy;\n        }\n\n        return new CellError(ErrorType.NUM);\n      });\n    }\n  }, {\n    key: \"pv\",\n    value: function pv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PV'), function (rate, periods, payment, future, type) {\n        type = type ? 1 : 0;\n\n        if (rate === -1) {\n          if (periods === 0) {\n            return new CellError(ErrorType.NUM);\n          } else {\n            return new CellError(ErrorType.DIV_BY_ZERO);\n          }\n        }\n\n        if (rate === 0) {\n          return -payment * periods - future;\n        } else {\n          return ((1 - Math.pow(1 + rate, periods)) * payment * (1 + rate * type) / rate - future) / Math.pow(1 + rate, periods);\n        }\n      });\n    }\n  }, {\n    key: \"rri\",\n    value: function rri(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('RRI'), function (periods, present, future) {\n        if (present === 0 || future < 0 && present > 0 || future > 0 && present < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return Math.pow(future / present, 1 / periods) - 1;\n      });\n    }\n  }, {\n    key: \"sln\",\n    value: function sln(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SLN'), function (cost, salvage, life) {\n        if (life === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return (cost - salvage) / life;\n      });\n    }\n  }, {\n    key: \"syd\",\n    value: function syd(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SYD'), function (cost, salvage, life, period) {\n        if (period > life) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return (cost - salvage) * (life - period + 1) * 2 / (life * (life + 1));\n      });\n    }\n  }, {\n    key: \"tbilleq\",\n    value: function tbilleq(ast, state) {\n      var _this = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLEQ'), function (settlement, maturity, discount) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var denom = 360 - discount * (maturity - settlement);\n\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (denom < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return 365 * discount / denom;\n      });\n    }\n  }, {\n    key: \"tbillprice\",\n    value: function tbillprice(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLPRICE'), function (settlement, maturity, discount) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this2.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this2.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var denom = 360 - discount * (maturity - settlement);\n\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (denom < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return 100 * (1 - discount * (maturity - settlement) / 360);\n      });\n    }\n  }, {\n    key: \"tbillyield\",\n    value: function tbillyield(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLYIELD'), function (settlement, maturity, price) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this3.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this3.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return (100 - price) * 360 / (price * (maturity - settlement));\n      });\n    }\n  }, {\n    key: \"fvschedule\",\n    value: function fvschedule(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FVSCHEDULE'), function (value, ratios) {\n        var vals = ratios.valuesFromTopLeftCorner();\n\n        var _iterator = _createForOfIteratorHelper(vals),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var val = _step.value;\n\n            if (val instanceof CellError) {\n              return val;\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        var _iterator2 = _createForOfIteratorHelper(vals),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _val = _step2.value;\n\n            if (isExtendedNumber(_val)) {\n              value *= 1 + getRawValue(_val);\n            } else if (_val !== EmptyValue) {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        return value;\n      });\n    }\n  }, {\n    key: \"npv\",\n    value: function npv(ast, state) {\n      var _this4 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NPV'), function (rate) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var coerced = _this4.arithmeticHelper.coerceNumbersExactRanges(args);\n\n        if (coerced instanceof CellError) {\n          return coerced;\n        }\n\n        return npvCore(rate, coerced);\n      });\n    }\n  }, {\n    key: \"mirr\",\n    value: function mirr(ast, state) {\n      var _this5 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('MIRR'), function (range, frate, rrate) {\n        var vals = _this5.arithmeticHelper.manyToExactNumbers(range.valuesFromTopLeftCorner());\n\n        if (vals instanceof CellError) {\n          return vals;\n        }\n\n        var posFlag = false;\n        var negFlag = false;\n        var posValues = [];\n        var negValues = [];\n\n        var _iterator3 = _createForOfIteratorHelper(vals),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var val = _step3.value;\n\n            if (val > 0) {\n              posFlag = true;\n              posValues.push(val);\n              negValues.push(0);\n            } else if (val < 0) {\n              negFlag = true;\n              negValues.push(val);\n              posValues.push(0);\n            } else {\n              negValues.push(0);\n              posValues.push(0);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        if (!posFlag || !negFlag) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        var n = vals.length;\n        var nom = npvCore(rrate, posValues);\n\n        if (nom instanceof CellError) {\n          return nom;\n        }\n\n        var denom = npvCore(frate, negValues);\n\n        if (denom instanceof CellError) {\n          return denom;\n        }\n\n        return Math.pow(-nom * Math.pow(1 + rrate, n) / denom / (1 + frate), 1 / (n - 1)) - 1;\n      });\n    }\n  }, {\n    key: \"pduration\",\n    value: function pduration(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PDURATION'), function (rate, pv, fv) {\n        return (Math.log(fv) - Math.log(pv)) / Math.log(1 + rate);\n      });\n    }\n  }, {\n    key: \"xnpv\",\n    value: function xnpv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('XNPV'), function (rate, values, dates) {\n        var valArr = values.valuesFromTopLeftCorner();\n\n        var _iterator4 = _createForOfIteratorHelper(valArr),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var val = _step4.value;\n\n            if (typeof val !== 'number') {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n\n        var valArrNum = valArr;\n        var dateArr = dates.valuesFromTopLeftCorner();\n\n        var _iterator5 = _createForOfIteratorHelper(dateArr),\n            _step5;\n\n        try {\n          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n            var date = _step5.value;\n\n            if (typeof date !== 'number') {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator5.e(err);\n        } finally {\n          _iterator5.f();\n        }\n\n        var dateArrNum = dateArr;\n\n        if (dateArrNum.length !== valArrNum.length) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EqualLength);\n        }\n\n        var n = dateArrNum.length;\n        var ret = 0;\n\n        if (dateArrNum[0] < 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n        }\n\n        for (var i = 0; i < n; i++) {\n          dateArrNum[i] = Math.floor(dateArrNum[i]);\n\n          if (dateArrNum[i] < dateArrNum[0]) {\n            return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n          }\n\n          ret += valArrNum[i] / Math.pow(1 + rate, (dateArrNum[i] - dateArrNum[0]) / 365);\n        }\n\n        return ret;\n      });\n    }\n  }]);\n\n  return FinancialPlugin;\n}(FunctionPlugin);\nFinancialPlugin.implementedFunctions = {\n  'PMT': {\n    method: 'pmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'IPMT': {\n    method: 'ipmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'PPMT': {\n    method: 'ppmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'FV': {\n    method: 'fv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'CUMIPMT': {\n    method: 'cumipmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0,\n      maxValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'CUMPRINC': {\n    method: 'cumprinc',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0,\n      maxValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DB': {\n    method: 'db',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1,\n      maxValue: 12,\n      defaultValue: 12\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DDB': {\n    method: 'ddb',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0,\n      defaultValue: 2\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DOLLARDE': {\n    method: 'dollarde',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DOLLARFR': {\n    method: 'dollarfr',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'EFFECT': {\n    method: 'effect',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'ISPMT': {\n    method: 'ispmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'NOMINAL': {\n    method: 'nominal',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'NPER': {\n    method: 'nper',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }]\n  },\n  'PV': {\n    method: 'pv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'RATE': {\n    method: 'rate',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0.1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'RRI': {\n    method: 'rri',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'SLN': {\n    method: 'sln',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'SYD': {\n    method: 'syd',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'TBILLEQ': {\n    method: 'tbilleq',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'TBILLPRICE': {\n    method: 'tbillprice',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'TBILLYIELD': {\n    method: 'tbillyield',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'FVSCHEDULE': {\n    method: 'fvschedule',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'NPV': {\n    method: 'npv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1,\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'MIRR': {\n    method: 'mirr',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'PDURATION': {\n    method: 'pduration',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }]\n  },\n  'XNPV': {\n    method: 'xnpv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: -1\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  }\n};\n\nfunction pmtCore(rate, periods, present, future, type) {\n  if (rate === 0) {\n    return (-present - future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    return (future * rate + present * rate * term) * (type ? 1 / (1 + rate) : 1) / (1 - term);\n  }\n}\n\nfunction ipmtCore(rate, period, periods, present, future, type) {\n  var payment = pmtCore(rate, periods, present, future, type);\n\n  if (period === 1) {\n    return rate * (type ? 0 : -present);\n  } else {\n    return rate * (type ? fvCore(rate, period - 2, payment, present, type) - payment : fvCore(rate, period - 1, payment, present, type));\n  }\n}\n\nfunction fvCore(rate, periods, payment, value, type) {\n  if (rate === 0) {\n    return -value - payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    return payment * (type ? 1 + rate : 1) * (1 - term) / rate - value * term;\n  }\n}\n\nfunction ppmtCore(rate, period, periods, present, future, type) {\n  return pmtCore(rate, periods, present, future, type) - ipmtCore(rate, period, periods, present, future, type);\n}\n\nfunction npvCore(rate, args) {\n  var acc = 0;\n\n  for (var i = args.length - 1; i >= 0; i--) {\n    acc += args[i];\n\n    if (rate === -1) {\n      if (acc === 0) {\n        continue;\n      } else {\n        return new CellError(ErrorType.DIV_BY_ZERO);\n      }\n    }\n\n    acc /= 1 + rate;\n  }\n\n  return acc;\n}","map":{"version":3,"sources":["/Users/mingjie.wang/Documents/Uber/MandA/demo-project/node_modules/hyperformula/es/interpreter/plugin/FinancialPlugin.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","return","minLen","_arrayLikeToArray","Object","toString","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","CellError","ErrorType","ErrorMessage","EmptyValue","getRawValue","isExtendedNumber","NumberType","ArgumentTypes","FunctionPlugin","FinancialPlugin","_FunctionPlugin","_super","pmt","ast","state","runFunction","args","metadata","pmtCore","ipmt","ipmtCore","ppmt","ppmtCore","fv","fvCore","cumipmt","rate","periods","start","end","type","NUM","EndStartPeriod","acc","cumprinc","db","cost","salvage","life","period","month","PeriodLong","Math","round","pow","initial","total","ddb","factor","oldValue","newValue","max","dollarde","dollar","fraction","DIV_BY_ZERO","trunc","dollarfr","effect","ispmt","nominal","nper","payment","present","future","log","guess","VALUE","epsMax","iterMax","y","abs","dy","_f","df","pv","rri","sln","syd","tbilleq","_this","settlement","maturity","discount","startDate","dateTimeHelper","numberToSimpleDate","endDate","year","day","denom","tbillprice","_this2","tbillyield","_this3","price","fvschedule","ratios","vals","valuesFromTopLeftCorner","_iterator","_step","val","_iterator2","_step2","_val","NumberExpected","npv","_this4","_len","_key","coerced","arithmeticHelper","coerceNumbersExactRanges","npvCore","mirr","_this5","range","frate","rrate","manyToExactNumbers","posFlag","negFlag","posValues","negValues","_iterator3","_step3","push","nom","pduration","xnpv","values","dates","valArr","_iterator4","_step4","valArrNum","dateArr","_iterator5","_step5","date","dateArrNum","EqualLength","ret","ValueSmall","floor","implementedFunctions","method","parameters","argumentType","NUMBER","defaultValue","returnNumberType","NUMBER_CURRENCY","greaterThan","INTEGER","minValue","maxValue","NUMBER_PERCENT","RANGE","ANY","repeatLastArgs","term"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport \"core-js/modules/es.math.trunc.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\nimport { CellError, ErrorType } from '../../Cell';\nimport { ErrorMessage } from '../../error-message';\nimport { EmptyValue, getRawValue, isExtendedNumber, NumberType } from '../InterpreterValue';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\nexport var FinancialPlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(FinancialPlugin, _FunctionPlugin);\n\n  var _super = _createSuper(FinancialPlugin);\n\n  function FinancialPlugin() {\n    _classCallCheck(this, FinancialPlugin);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(FinancialPlugin, [{\n    key: \"pmt\",\n    value: function pmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PMT'), pmtCore);\n    }\n  }, {\n    key: \"ipmt\",\n    value: function ipmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('IPMT'), ipmtCore);\n    }\n  }, {\n    key: \"ppmt\",\n    value: function ppmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PPMT'), ppmtCore);\n    }\n  }, {\n    key: \"fv\",\n    value: function fv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FV'), fvCore);\n    }\n  }, {\n    key: \"cumipmt\",\n    value: function cumipmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('CUMIPMT'), function (rate, periods, value, start, end, type) {\n        if (start > end) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EndStartPeriod);\n        }\n\n        var acc = 0;\n\n        for (var i = start; i <= end; i++) {\n          acc += ipmtCore(rate, i, periods, value, 0, type);\n        }\n\n        return acc;\n      });\n    }\n  }, {\n    key: \"cumprinc\",\n    value: function cumprinc(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('CUMPRINC'), function (rate, periods, value, start, end, type) {\n        if (start > end) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EndStartPeriod);\n        }\n\n        var acc = 0;\n\n        for (var i = start; i <= end; i++) {\n          acc += ppmtCore(rate, i, periods, value, 0, type);\n        }\n\n        return acc;\n      });\n    }\n  }, {\n    key: \"db\",\n    value: function db(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DB'), function (cost, salvage, life, period, month) {\n        if (month === 12 && period > life || period > life + 1) {\n          return new CellError(ErrorType.NUM, ErrorMessage.PeriodLong);\n        }\n\n        if (salvage >= cost) {\n          return 0;\n        }\n\n        var rate = Math.round((1 - Math.pow(salvage / cost, 1 / life)) * 1000) / 1000;\n        var initial = cost * rate * month / 12;\n\n        if (period === 1) {\n          return initial;\n        }\n\n        var total = initial;\n\n        for (var i = 0; i < period - 2; i++) {\n          total += (cost - total) * rate;\n        }\n\n        if (period === life + 1) {\n          return (cost - total) * rate * (12 - month) / 12;\n        }\n\n        return (cost - total) * rate;\n      });\n    }\n  }, {\n    key: \"ddb\",\n    value: function ddb(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DDB'), function (cost, salvage, life, period, factor) {\n        if (period > life) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var rate = factor / life;\n        var oldValue;\n\n        if (rate >= 1) {\n          rate = 1;\n\n          if (period === 1) {\n            oldValue = cost;\n          } else {\n            oldValue = 0;\n          }\n        } else {\n          oldValue = cost * Math.pow(1 - rate, period - 1);\n        }\n\n        var newValue = cost * Math.pow(1 - rate, period);\n        return Math.max(oldValue - Math.max(salvage, newValue), 0);\n      });\n    }\n  }, {\n    key: \"dollarde\",\n    value: function dollarde(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DOLLARDE'), function (dollar, fraction) {\n        if (fraction < 1) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        fraction = Math.trunc(fraction);\n\n        while (fraction > 10) {\n          fraction /= 10;\n        }\n\n        return Math.trunc(dollar) + (dollar - Math.trunc(dollar)) * 10 / fraction;\n      });\n    }\n  }, {\n    key: \"dollarfr\",\n    value: function dollarfr(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DOLLARFR'), function (dollar, fraction) {\n        if (fraction < 1) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        fraction = Math.trunc(fraction);\n\n        while (fraction > 10) {\n          fraction /= 10;\n        }\n\n        return Math.trunc(dollar) + (dollar - Math.trunc(dollar)) * fraction / 10;\n      });\n    }\n  }, {\n    key: \"effect\",\n    value: function effect(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('EFFECT'), function (rate, periods) {\n        periods = Math.trunc(periods);\n        return Math.pow(1 + rate / periods, periods) - 1;\n      });\n    }\n  }, {\n    key: \"ispmt\",\n    value: function ispmt(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('ISPMT'), function (rate, period, periods, value) {\n        if (periods === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return value * rate * (period / periods - 1);\n      });\n    }\n  }, {\n    key: \"nominal\",\n    value: function nominal(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('NOMINAL'), function (rate, periods) {\n        periods = Math.trunc(periods);\n        return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\n      });\n    }\n  }, {\n    key: \"nper\",\n    value: function nper(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('NPER'), function (rate, payment, present, future, type) {\n        if (rate === 0) {\n          if (payment === 0) {\n            return new CellError(ErrorType.DIV_BY_ZERO);\n          }\n\n          return (-present - future) / payment;\n        }\n\n        if (type) {\n          payment *= 1 + rate;\n        }\n\n        return Math.log((payment - future * rate) / (present * rate + payment)) / Math.log(1 + rate);\n      });\n    }\n  }, {\n    key: \"rate\",\n    value: function rate(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('RATE'), function (periods, payment, present, future, type, guess) {\n        if (guess <= -1) {\n          return new CellError(ErrorType.VALUE);\n        }\n\n        var epsMax = 1e-10;\n        var iterMax = 20;\n        var rate = guess;\n        type = type ? 1 : 0;\n\n        for (var i = 0; i < iterMax; i++) {\n          if (rate <= -1) {\n            return new CellError(ErrorType.NUM);\n          }\n\n          var y = void 0;\n\n          if (Math.abs(rate) < epsMax) {\n            y = present * (1 + periods * rate) + payment * (1 + rate * type) * periods + future;\n          } else {\n            var f = Math.pow(1 + rate, periods);\n            y = present * f + payment * (1 / rate + type) * (f - 1) + future;\n          }\n\n          if (Math.abs(y) < epsMax) {\n            return rate;\n          }\n\n          var dy = void 0;\n\n          if (Math.abs(rate) < epsMax) {\n            dy = present * periods + payment * type * periods;\n          } else {\n            var _f = Math.pow(1 + rate, periods);\n\n            var df = periods * Math.pow(1 + rate, periods - 1);\n            dy = present * df + payment * (1 / rate + type) * df + payment * (-1 / (rate * rate)) * (_f - 1);\n          }\n\n          rate -= y / dy;\n        }\n\n        return new CellError(ErrorType.NUM);\n      });\n    }\n  }, {\n    key: \"pv\",\n    value: function pv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PV'), function (rate, periods, payment, future, type) {\n        type = type ? 1 : 0;\n\n        if (rate === -1) {\n          if (periods === 0) {\n            return new CellError(ErrorType.NUM);\n          } else {\n            return new CellError(ErrorType.DIV_BY_ZERO);\n          }\n        }\n\n        if (rate === 0) {\n          return -payment * periods - future;\n        } else {\n          return ((1 - Math.pow(1 + rate, periods)) * payment * (1 + rate * type) / rate - future) / Math.pow(1 + rate, periods);\n        }\n      });\n    }\n  }, {\n    key: \"rri\",\n    value: function rri(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('RRI'), function (periods, present, future) {\n        if (present === 0 || future < 0 && present > 0 || future > 0 && present < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return Math.pow(future / present, 1 / periods) - 1;\n      });\n    }\n  }, {\n    key: \"sln\",\n    value: function sln(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SLN'), function (cost, salvage, life) {\n        if (life === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return (cost - salvage) / life;\n      });\n    }\n  }, {\n    key: \"syd\",\n    value: function syd(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SYD'), function (cost, salvage, life, period) {\n        if (period > life) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return (cost - salvage) * (life - period + 1) * 2 / (life * (life + 1));\n      });\n    }\n  }, {\n    key: \"tbilleq\",\n    value: function tbilleq(ast, state) {\n      var _this = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLEQ'), function (settlement, maturity, discount) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var denom = 360 - discount * (maturity - settlement);\n\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (denom < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return 365 * discount / denom;\n      });\n    }\n  }, {\n    key: \"tbillprice\",\n    value: function tbillprice(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLPRICE'), function (settlement, maturity, discount) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this2.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this2.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var denom = 360 - discount * (maturity - settlement);\n\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (denom < 0) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return 100 * (1 - discount * (maturity - settlement) / 360);\n      });\n    }\n  }, {\n    key: \"tbillyield\",\n    value: function tbillyield(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TBILLYIELD'), function (settlement, maturity, price) {\n        settlement = Math.round(settlement);\n        maturity = Math.round(maturity);\n\n        if (settlement >= maturity) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        var startDate = _this3.dateTimeHelper.numberToSimpleDate(settlement);\n\n        var endDate = _this3.dateTimeHelper.numberToSimpleDate(maturity);\n\n        if (endDate.year > startDate.year + 1 || endDate.year === startDate.year + 1 && (endDate.month > startDate.month || endDate.month === startDate.month && endDate.day > startDate.day)) {\n          return new CellError(ErrorType.NUM);\n        }\n\n        return (100 - price) * 360 / (price * (maturity - settlement));\n      });\n    }\n  }, {\n    key: \"fvschedule\",\n    value: function fvschedule(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FVSCHEDULE'), function (value, ratios) {\n        var vals = ratios.valuesFromTopLeftCorner();\n\n        var _iterator = _createForOfIteratorHelper(vals),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var val = _step.value;\n\n            if (val instanceof CellError) {\n              return val;\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        var _iterator2 = _createForOfIteratorHelper(vals),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _val = _step2.value;\n\n            if (isExtendedNumber(_val)) {\n              value *= 1 + getRawValue(_val);\n            } else if (_val !== EmptyValue) {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        return value;\n      });\n    }\n  }, {\n    key: \"npv\",\n    value: function npv(ast, state) {\n      var _this4 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NPV'), function (rate) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        var coerced = _this4.arithmeticHelper.coerceNumbersExactRanges(args);\n\n        if (coerced instanceof CellError) {\n          return coerced;\n        }\n\n        return npvCore(rate, coerced);\n      });\n    }\n  }, {\n    key: \"mirr\",\n    value: function mirr(ast, state) {\n      var _this5 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('MIRR'), function (range, frate, rrate) {\n        var vals = _this5.arithmeticHelper.manyToExactNumbers(range.valuesFromTopLeftCorner());\n\n        if (vals instanceof CellError) {\n          return vals;\n        }\n\n        var posFlag = false;\n        var negFlag = false;\n        var posValues = [];\n        var negValues = [];\n\n        var _iterator3 = _createForOfIteratorHelper(vals),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var val = _step3.value;\n\n            if (val > 0) {\n              posFlag = true;\n              posValues.push(val);\n              negValues.push(0);\n            } else if (val < 0) {\n              negFlag = true;\n              negValues.push(val);\n              posValues.push(0);\n            } else {\n              negValues.push(0);\n              posValues.push(0);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        if (!posFlag || !negFlag) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        var n = vals.length;\n        var nom = npvCore(rrate, posValues);\n\n        if (nom instanceof CellError) {\n          return nom;\n        }\n\n        var denom = npvCore(frate, negValues);\n\n        if (denom instanceof CellError) {\n          return denom;\n        }\n\n        return Math.pow(-nom * Math.pow(1 + rrate, n) / denom / (1 + frate), 1 / (n - 1)) - 1;\n      });\n    }\n  }, {\n    key: \"pduration\",\n    value: function pduration(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('PDURATION'), function (rate, pv, fv) {\n        return (Math.log(fv) - Math.log(pv)) / Math.log(1 + rate);\n      });\n    }\n  }, {\n    key: \"xnpv\",\n    value: function xnpv(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('XNPV'), function (rate, values, dates) {\n        var valArr = values.valuesFromTopLeftCorner();\n\n        var _iterator4 = _createForOfIteratorHelper(valArr),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var val = _step4.value;\n\n            if (typeof val !== 'number') {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n\n        var valArrNum = valArr;\n        var dateArr = dates.valuesFromTopLeftCorner();\n\n        var _iterator5 = _createForOfIteratorHelper(dateArr),\n            _step5;\n\n        try {\n          for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n            var date = _step5.value;\n\n            if (typeof date !== 'number') {\n              return new CellError(ErrorType.VALUE, ErrorMessage.NumberExpected);\n            }\n          }\n        } catch (err) {\n          _iterator5.e(err);\n        } finally {\n          _iterator5.f();\n        }\n\n        var dateArrNum = dateArr;\n\n        if (dateArrNum.length !== valArrNum.length) {\n          return new CellError(ErrorType.NUM, ErrorMessage.EqualLength);\n        }\n\n        var n = dateArrNum.length;\n        var ret = 0;\n\n        if (dateArrNum[0] < 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n        }\n\n        for (var i = 0; i < n; i++) {\n          dateArrNum[i] = Math.floor(dateArrNum[i]);\n\n          if (dateArrNum[i] < dateArrNum[0]) {\n            return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n          }\n\n          ret += valArrNum[i] / Math.pow(1 + rate, (dateArrNum[i] - dateArrNum[0]) / 365);\n        }\n\n        return ret;\n      });\n    }\n  }]);\n\n  return FinancialPlugin;\n}(FunctionPlugin);\nFinancialPlugin.implementedFunctions = {\n  'PMT': {\n    method: 'pmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'IPMT': {\n    method: 'ipmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'PPMT': {\n    method: 'ppmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'FV': {\n    method: 'fv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'CUMIPMT': {\n    method: 'cumipmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0,\n      maxValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'CUMPRINC': {\n    method: 'cumprinc',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0,\n      maxValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DB': {\n    method: 'db',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 1,\n      maxValue: 12,\n      defaultValue: 12\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DDB': {\n    method: 'ddb',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0,\n      defaultValue: 2\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'DOLLARDE': {\n    method: 'dollarde',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DOLLARFR': {\n    method: 'dollarfr',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'EFFECT': {\n    method: 'effect',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'ISPMT': {\n    method: 'ispmt',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'NOMINAL': {\n    method: 'nominal',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'NPER': {\n    method: 'nper',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }]\n  },\n  'PV': {\n    method: 'pv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'RATE': {\n    method: 'rate',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 0.1\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'RRI': {\n    method: 'rri',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'SLN': {\n    method: 'sln',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'SYD': {\n    method: 'syd',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'TBILLEQ': {\n    method: 'tbilleq',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'TBILLPRICE': {\n    method: 'tbillprice',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'TBILLYIELD': {\n    method: 'tbillyield',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'FVSCHEDULE': {\n    method: 'fvschedule',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }],\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'NPV': {\n    method: 'npv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1,\n    returnNumberType: NumberType.NUMBER_CURRENCY\n  },\n  'MIRR': {\n    method: 'mirr',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_PERCENT\n  },\n  'PDURATION': {\n    method: 'pduration',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: 0\n    }]\n  },\n  'XNPV': {\n    method: 'xnpv',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      greaterThan: -1\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  }\n};\n\nfunction pmtCore(rate, periods, present, future, type) {\n  if (rate === 0) {\n    return (-present - future) / periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    return (future * rate + present * rate * term) * (type ? 1 / (1 + rate) : 1) / (1 - term);\n  }\n}\n\nfunction ipmtCore(rate, period, periods, present, future, type) {\n  var payment = pmtCore(rate, periods, present, future, type);\n\n  if (period === 1) {\n    return rate * (type ? 0 : -present);\n  } else {\n    return rate * (type ? fvCore(rate, period - 2, payment, present, type) - payment : fvCore(rate, period - 1, payment, present, type));\n  }\n}\n\nfunction fvCore(rate, periods, payment, value, type) {\n  if (rate === 0) {\n    return -value - payment * periods;\n  } else {\n    var term = Math.pow(1 + rate, periods);\n    return payment * (type ? 1 + rate : 1) * (1 - term) / rate - value * term;\n  }\n}\n\nfunction ppmtCore(rate, period, periods, present, future, type) {\n  return pmtCore(rate, periods, present, future, type) - ipmtCore(rate, period, periods, present, future, type);\n}\n\nfunction npvCore(rate, args) {\n  var acc = 0;\n\n  for (var i = args.length - 1; i >= 0; i--) {\n    acc += args[i];\n\n    if (rate === -1) {\n      if (acc === 0) {\n        continue;\n      } else {\n        return new CellError(ErrorType.DIV_BY_ZERO);\n      }\n    }\n\n    acc /= 1 + rate;\n  }\n\n  return acc;\n}"]},"metadata":{},"sourceType":"module"}