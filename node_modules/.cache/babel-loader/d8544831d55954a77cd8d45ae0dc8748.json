{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\n\n\nimport { CellError, ErrorType } from '../../Cell';\nimport { ErrorMessage } from '../../error-message';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\nexport var MathPlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(MathPlugin, _FunctionPlugin);\n\n  var _super = _createSuper(MathPlugin);\n\n  function MathPlugin() {\n    _classCallCheck(this, MathPlugin);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(MathPlugin, [{\n    key: \"fact\",\n    value: function fact(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FACT'), function (arg) {\n        arg = Math.trunc(arg);\n        var ret = 1;\n\n        for (var i = 1; i <= arg; i++) {\n          ret *= i;\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"factdouble\",\n    value: function factdouble(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FACTDOUBLE'), function (arg) {\n        arg = Math.trunc(arg);\n        var ret = 1;\n\n        for (var i = arg; i >= 1; i -= 2) {\n          ret *= i;\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"combin\",\n    value: function combin(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('COMBIN'), function (n, m) {\n        if (m > n) {\n          return new CellError(ErrorType.NUM, ErrorMessage.WrongOrder);\n        }\n\n        n = Math.trunc(n);\n        m = Math.trunc(m);\n        return _combin(n, m);\n      });\n    }\n  }, {\n    key: \"combina\",\n    value: function combina(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('COMBINA'), function (n, m) {\n        n = Math.trunc(n);\n        m = Math.trunc(m);\n\n        if (n + m - 1 >= 1030) {\n          //Product #2 does not enforce this\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        if (n === 0 && m === 0) {\n          return 1;\n        }\n\n        return _combin(n + m - 1, m);\n      });\n    }\n  }, {\n    key: \"gcd\",\n    value: function gcd(ast, state) {\n      var _this = this;\n\n      return this.runFunction(ast.args, state, this.metadata('GCD'), function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        var processedArgs = _this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(args);\n\n        if (processedArgs instanceof CellError) {\n          return processedArgs;\n        }\n\n        var ret = 0;\n\n        var _iterator = _createForOfIteratorHelper(processedArgs),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var val = _step.value;\n\n            if (val < 0) {\n              return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n            }\n\n            ret = binaryGCD(ret, Math.trunc(val));\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        if (ret > Number.MAX_SAFE_INTEGER) {\n          //inconsistency with product #1\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"lcm\",\n    value: function lcm(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('LCM'), function () {\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        var processedArgs = _this2.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(args);\n\n        if (processedArgs instanceof CellError) {\n          return processedArgs;\n        }\n\n        var ret = 1;\n\n        var _iterator2 = _createForOfIteratorHelper(processedArgs),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var val = _step2.value;\n\n            if (val < 0) {\n              return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n            }\n\n            ret = binaryLCM(ret, Math.trunc(val));\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        if (ret > Number.MAX_SAFE_INTEGER) {\n          //inconsistency with product #1\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"mround\",\n    value: function mround(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MROUND'), function (nom, denom) {\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (nom > 0 && denom < 0 || nom < 0 && denom > 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DistinctSigns);\n        }\n\n        return Math.round(nom / denom) * denom;\n      });\n    }\n  }, {\n    key: \"multinomial\",\n    value: function multinomial(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MULTINOMIAL'), function () {\n        var n = 0;\n        var ans = 1;\n\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n\n        for (var _i = 0, _args = args; _i < _args.length; _i++) {\n          var arg = _args[_i];\n\n          if (arg < 0) {\n            return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n          }\n\n          arg = Math.trunc(arg);\n\n          for (var i = 1; i <= arg; i++) {\n            ans *= (n + i) / i;\n          }\n\n          n += arg;\n        }\n\n        return Math.round(ans);\n      });\n    }\n  }, {\n    key: \"quotient\",\n    value: function quotient(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('QUOTIENT'), function (nom, denom) {\n        if (denom === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return Math.trunc(nom / denom);\n      });\n    }\n  }, {\n    key: \"seriessum\",\n    value: function seriessum(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('SERIESSUM'), function (x, n, m, range) {\n        var coefs = _this3.arithmeticHelper.manyToOnlyNumbersDropNulls(range.valuesFromTopLeftCorner());\n\n        if (coefs instanceof CellError) {\n          return coefs;\n        }\n\n        var ret = 0;\n        coefs.reverse();\n\n        var _iterator3 = _createForOfIteratorHelper(coefs),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var coef = _step3.value;\n            ret *= Math.pow(x, m);\n            ret += coef;\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        return ret * Math.pow(x, n);\n      });\n    }\n  }, {\n    key: \"sign\",\n    value: function sign(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SIGN'), function (arg) {\n        if (arg > 0) {\n          return 1;\n        } else if (arg < 0) {\n          return -1;\n        } else {\n          return 0;\n        }\n      });\n    }\n  }, {\n    key: \"sumx2my2\",\n    value: function sumx2my2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMX2MY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX, 2) - Math.pow(valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"sumx2py2\",\n    value: function sumx2py2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMX2PY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX, 2) + Math.pow(valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"sumxmy2\",\n    value: function sumxmy2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMXMY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX - valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }]);\n\n  return MathPlugin;\n}(FunctionPlugin);\nMathPlugin.implementedFunctions = {\n  'FACT': {\n    method: 'fact',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      maxValue: 170\n    }]\n  },\n  'FACTDOUBLE': {\n    method: 'factdouble',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      maxValue: 288\n    }]\n  },\n  'COMBIN': {\n    method: 'combin',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      lessThan: 1030\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'COMBINA': {\n    method: 'combina',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'GCD': {\n    method: 'gcd',\n    parameters: [{\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1\n  },\n  'LCM': {\n    method: 'lcm',\n    parameters: [{\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1\n  },\n  'MROUND': {\n    method: 'mround',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'MULTINOMIAL': {\n    method: 'multinomial',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    repeatLastArgs: 1,\n    expandRanges: true\n  },\n  'QUOTIENT': {\n    method: 'quotient',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'SERIESSUM': {\n    method: 'seriessum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SIGN': {\n    method: 'sign',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'SUMX2MY2': {\n    method: 'sumx2my2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SUMX2PY2': {\n    method: 'sumx2py2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SUMXMY2': {\n    method: 'sumxmy2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  }\n};\n\nfunction _combin(n, m) {\n  if (2 * m > n) {\n    m = n - m;\n  }\n\n  var ret = 1;\n\n  for (var i = 1; i <= m; i++) {\n    ret *= (n - m + i) / i;\n  }\n\n  return Math.round(ret);\n}\n\nfunction binaryGCD(a, b) {\n  if (a < b) {\n    var _ref = [b, a];\n    a = _ref[0];\n    b = _ref[1];\n  }\n\n  while (b > 0) {\n    var _ref2 = [b, a % b];\n    a = _ref2[0];\n    b = _ref2[1];\n  }\n\n  return a;\n}\n\nfunction binaryLCM(a, b) {\n  if (a === 0 || b === 0) {\n    return 0;\n  }\n\n  return a * (b / binaryGCD(a, b));\n}","map":{"version":3,"sources":["/Users/mingjie.wang/Documents/Uber/MandA/demo-project/node_modules/hyperformula/es/interpreter/plugin/MathPlugin.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_createForOfIteratorHelper","o","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","return","minLen","_arrayLikeToArray","Object","toString","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","CellError","ErrorType","ErrorMessage","ArgumentTypes","FunctionPlugin","MathPlugin","_FunctionPlugin","_super","fact","ast","state","runFunction","args","metadata","arg","Math","trunc","ret","factdouble","combin","m","NUM","WrongOrder","_combin","combina","ValueLarge","gcd","_this","_len","_key","processedArgs","arithmeticHelper","coerceNumbersCoerceRangesDropNulls","_iterator","_step","val","ValueSmall","binaryGCD","Number","MAX_SAFE_INTEGER","lcm","_this2","_len2","_key2","_iterator2","_step2","binaryLCM","mround","nom","denom","DistinctSigns","round","multinomial","ans","_len3","_key3","_i","_args","quotient","DIV_BY_ZERO","seriessum","_this3","x","range","coefs","manyToOnlyNumbersDropNulls","valuesFromTopLeftCorner","reverse","_iterator3","_step3","coef","pow","sign","sumx2my2","rangeX","rangeY","valsX","valsY","NA","EqualLength","valX","valY","sumx2py2","sumxmy2","implementedFunctions","method","parameters","argumentType","NUMBER","minValue","maxValue","lessThan","ANY","repeatLastArgs","expandRanges","RANGE","a","b","_ref","_ref2"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport \"core-js/modules/es.math.trunc.js\";\nimport \"core-js/modules/es.number.max-safe-integer.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.reverse.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\nimport { CellError, ErrorType } from '../../Cell';\nimport { ErrorMessage } from '../../error-message';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\nexport var MathPlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(MathPlugin, _FunctionPlugin);\n\n  var _super = _createSuper(MathPlugin);\n\n  function MathPlugin() {\n    _classCallCheck(this, MathPlugin);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(MathPlugin, [{\n    key: \"fact\",\n    value: function fact(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FACT'), function (arg) {\n        arg = Math.trunc(arg);\n        var ret = 1;\n\n        for (var i = 1; i <= arg; i++) {\n          ret *= i;\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"factdouble\",\n    value: function factdouble(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('FACTDOUBLE'), function (arg) {\n        arg = Math.trunc(arg);\n        var ret = 1;\n\n        for (var i = arg; i >= 1; i -= 2) {\n          ret *= i;\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"combin\",\n    value: function combin(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('COMBIN'), function (n, m) {\n        if (m > n) {\n          return new CellError(ErrorType.NUM, ErrorMessage.WrongOrder);\n        }\n\n        n = Math.trunc(n);\n        m = Math.trunc(m);\n        return _combin(n, m);\n      });\n    }\n  }, {\n    key: \"combina\",\n    value: function combina(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('COMBINA'), function (n, m) {\n        n = Math.trunc(n);\n        m = Math.trunc(m);\n\n        if (n + m - 1 >= 1030) {\n          //Product #2 does not enforce this\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        if (n === 0 && m === 0) {\n          return 1;\n        }\n\n        return _combin(n + m - 1, m);\n      });\n    }\n  }, {\n    key: \"gcd\",\n    value: function gcd(ast, state) {\n      var _this = this;\n\n      return this.runFunction(ast.args, state, this.metadata('GCD'), function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n\n        var processedArgs = _this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(args);\n\n        if (processedArgs instanceof CellError) {\n          return processedArgs;\n        }\n\n        var ret = 0;\n\n        var _iterator = _createForOfIteratorHelper(processedArgs),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var val = _step.value;\n\n            if (val < 0) {\n              return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n            }\n\n            ret = binaryGCD(ret, Math.trunc(val));\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        if (ret > Number.MAX_SAFE_INTEGER) {\n          //inconsistency with product #1\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"lcm\",\n    value: function lcm(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('LCM'), function () {\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        var processedArgs = _this2.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(args);\n\n        if (processedArgs instanceof CellError) {\n          return processedArgs;\n        }\n\n        var ret = 1;\n\n        var _iterator2 = _createForOfIteratorHelper(processedArgs),\n            _step2;\n\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var val = _step2.value;\n\n            if (val < 0) {\n              return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n            }\n\n            ret = binaryLCM(ret, Math.trunc(val));\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n\n        if (ret > Number.MAX_SAFE_INTEGER) {\n          //inconsistency with product #1\n          return new CellError(ErrorType.NUM, ErrorMessage.ValueLarge);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"mround\",\n    value: function mround(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MROUND'), function (nom, denom) {\n        if (denom === 0) {\n          return 0;\n        }\n\n        if (nom > 0 && denom < 0 || nom < 0 && denom > 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DistinctSigns);\n        }\n\n        return Math.round(nom / denom) * denom;\n      });\n    }\n  }, {\n    key: \"multinomial\",\n    value: function multinomial(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MULTINOMIAL'), function () {\n        var n = 0;\n        var ans = 1;\n\n        for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n\n        for (var _i = 0, _args = args; _i < _args.length; _i++) {\n          var arg = _args[_i];\n\n          if (arg < 0) {\n            return new CellError(ErrorType.NUM, ErrorMessage.ValueSmall);\n          }\n\n          arg = Math.trunc(arg);\n\n          for (var i = 1; i <= arg; i++) {\n            ans *= (n + i) / i;\n          }\n\n          n += arg;\n        }\n\n        return Math.round(ans);\n      });\n    }\n  }, {\n    key: \"quotient\",\n    value: function quotient(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('QUOTIENT'), function (nom, denom) {\n        if (denom === 0) {\n          return new CellError(ErrorType.DIV_BY_ZERO);\n        }\n\n        return Math.trunc(nom / denom);\n      });\n    }\n  }, {\n    key: \"seriessum\",\n    value: function seriessum(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('SERIESSUM'), function (x, n, m, range) {\n        var coefs = _this3.arithmeticHelper.manyToOnlyNumbersDropNulls(range.valuesFromTopLeftCorner());\n\n        if (coefs instanceof CellError) {\n          return coefs;\n        }\n\n        var ret = 0;\n        coefs.reverse();\n\n        var _iterator3 = _createForOfIteratorHelper(coefs),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var coef = _step3.value;\n            ret *= Math.pow(x, m);\n            ret += coef;\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        return ret * Math.pow(x, n);\n      });\n    }\n  }, {\n    key: \"sign\",\n    value: function sign(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SIGN'), function (arg) {\n        if (arg > 0) {\n          return 1;\n        } else if (arg < 0) {\n          return -1;\n        } else {\n          return 0;\n        }\n      });\n    }\n  }, {\n    key: \"sumx2my2\",\n    value: function sumx2my2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMX2MY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX, 2) - Math.pow(valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"sumx2py2\",\n    value: function sumx2py2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMX2PY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX, 2) + Math.pow(valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"sumxmy2\",\n    value: function sumxmy2(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SUMXMY2'), function (rangeX, rangeY) {\n        var valsX = rangeX.valuesFromTopLeftCorner();\n        var valsY = rangeY.valuesFromTopLeftCorner();\n\n        if (valsX.length !== valsY.length) {\n          return new CellError(ErrorType.NA, ErrorMessage.EqualLength);\n        }\n\n        var n = valsX.length;\n        var ret = 0;\n\n        for (var i = 0; i < n; i++) {\n          var valX = valsX[i];\n          var valY = valsY[i];\n\n          if (valX instanceof CellError) {\n            return valX;\n          }\n\n          if (valY instanceof CellError) {\n            return valY;\n          }\n\n          if (typeof valX === 'number' && typeof valY === 'number') {\n            ret += Math.pow(valX - valY, 2);\n          }\n        }\n\n        return ret;\n      });\n    }\n  }]);\n\n  return MathPlugin;\n}(FunctionPlugin);\nMathPlugin.implementedFunctions = {\n  'FACT': {\n    method: 'fact',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      maxValue: 170\n    }]\n  },\n  'FACTDOUBLE': {\n    method: 'factdouble',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      maxValue: 288\n    }]\n  },\n  'COMBIN': {\n    method: 'combin',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0,\n      lessThan: 1030\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'COMBINA': {\n    method: 'combina',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'GCD': {\n    method: 'gcd',\n    parameters: [{\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1\n  },\n  'LCM': {\n    method: 'lcm',\n    parameters: [{\n      argumentType: ArgumentTypes.ANY\n    }],\n    repeatLastArgs: 1\n  },\n  'MROUND': {\n    method: 'mround',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'MULTINOMIAL': {\n    method: 'multinomial',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    repeatLastArgs: 1,\n    expandRanges: true\n  },\n  'QUOTIENT': {\n    method: 'quotient',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'SERIESSUM': {\n    method: 'seriessum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SIGN': {\n    method: 'sign',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }]\n  },\n  'SUMX2MY2': {\n    method: 'sumx2my2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SUMX2PY2': {\n    method: 'sumx2py2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  },\n  'SUMXMY2': {\n    method: 'sumxmy2',\n    parameters: [{\n      argumentType: ArgumentTypes.RANGE\n    }, {\n      argumentType: ArgumentTypes.RANGE\n    }]\n  }\n};\n\nfunction _combin(n, m) {\n  if (2 * m > n) {\n    m = n - m;\n  }\n\n  var ret = 1;\n\n  for (var i = 1; i <= m; i++) {\n    ret *= (n - m + i) / i;\n  }\n\n  return Math.round(ret);\n}\n\nfunction binaryGCD(a, b) {\n  if (a < b) {\n    var _ref = [b, a];\n    a = _ref[0];\n    b = _ref[1];\n  }\n\n  while (b > 0) {\n    var _ref2 = [b, a % b];\n    a = _ref2[0];\n    b = _ref2[1];\n  }\n\n  return a;\n}\n\nfunction binaryLCM(a, b) {\n  if (a === 0 || b === 0) {\n    return 0;\n  }\n\n  return a * (b / binaryGCD(a, b));\n}"]},"metadata":{},"sourceType":"module"}