{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e2) {\n          throw _e2;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e3) {\n      didErr = true;\n      err = _e3;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\n\n\nimport { CellError, ErrorType } from '../../Cell';\nimport { instanceOfSimpleDate, instanceOfSimpleTime, numberToSimpleTime, offsetMonth, roundToNearestSecond, timeToNumber, toBasisEU, truncateDayInMonth } from '../../DateTimeHelper';\nimport { ErrorMessage } from '../../error-message';\nimport { format } from '../../format/format';\nimport { EmptyValue, getRawValue, isExtendedNumber, NumberType } from '../InterpreterValue';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\n/**\n * Interpreter plugin containing date-specific functions\n */\n\nexport var DateTimePlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(DateTimePlugin, _FunctionPlugin);\n\n  var _super = _createSuper(DateTimePlugin);\n\n  function DateTimePlugin() {\n    var _this;\n\n    _classCallCheck(this, DateTimePlugin);\n\n    _this = _super.apply(this, arguments);\n\n    _this.isoweeknumCore = function (day) {\n      var absoluteDay = Math.floor(_this.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n      var date = _this.dateTimeHelper.numberToSimpleDate(day);\n\n      var yearStart = _this.dateTimeHelper.dateToNumber({\n        year: date.year,\n        month: 1,\n        day: 1\n      });\n\n      var yearStartAbsolute = _this.dateTimeHelper.relativeNumberToAbsoluteNumber(yearStart);\n\n      var firstThursdayAbs = yearStartAbsolute + ((4 - yearStartAbsolute) % 7 + 7) % 7;\n      var ret = Math.floor((absoluteDay - 1) / 7) - Math.floor((firstThursdayAbs - 1) / 7) + 1;\n\n      if (ret === 0) {\n        return _this.isoweeknumCore(day - 7) + 1;\n      }\n\n      return ret;\n    };\n\n    _this.days360Core = function (startDate, endDate, mode) {\n      var start = _this.dateTimeHelper.numberToSimpleDate(startDate);\n\n      var end = _this.dateTimeHelper.numberToSimpleDate(endDate);\n\n      var nStart, nEnd;\n\n      if (mode) {\n        nStart = toBasisEU(start);\n        nEnd = toBasisEU(end);\n      } else {\n        var _this$dateTimeHelper$ = _this.dateTimeHelper.toBasisUS(start, end);\n\n        var _this$dateTimeHelper$2 = _slicedToArray(_this$dateTimeHelper$, 2);\n\n        nStart = _this$dateTimeHelper$2[0];\n        nEnd = _this$dateTimeHelper$2[1];\n      }\n\n      return 360 * (nEnd.year - nStart.year) + 30 * (nEnd.month - nStart.month) + nEnd.day - nStart.day;\n    };\n\n    return _this;\n  }\n  /**\n   * Corresponds to DATE(year, month, day)\n   *\n   * Converts a provided year, month and day into date\n   *\n   * @param ast\n   * @param state\n   */\n\n\n  _createClass(DateTimePlugin, [{\n    key: \"date\",\n    value: function date(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATE'), function (year, month, day) {\n        var d = Math.trunc(day);\n        var m = Math.trunc(month);\n        var y = Math.trunc(year);\n\n        if (y < _this2.dateTimeHelper.getEpochYearZero()) {\n          y += _this2.dateTimeHelper.getEpochYearZero();\n        }\n\n        var delta = Math.floor((m - 1) / 12);\n        y += delta;\n        m -= delta * 12;\n        var date = {\n          year: y,\n          month: m,\n          day: 1\n        };\n\n        if (_this2.dateTimeHelper.isValidDate(date)) {\n          var ret = _this2.dateTimeHelper.dateToNumber(date) + (d - 1);\n          ret = _this2.dateTimeHelper.getWithinBounds(ret);\n\n          if (ret === undefined) {\n            return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n          }\n\n          return ret;\n        }\n\n        return new CellError(ErrorType.VALUE, ErrorMessage.InvalidDate);\n      });\n    }\n  }, {\n    key: \"time\",\n    value: function time(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('TIME'), function (h, m, s) {\n        var ret = timeToNumber({\n          hours: Math.trunc(h),\n          minutes: Math.trunc(m),\n          seconds: Math.trunc(s)\n        });\n\n        if (ret < 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.NegativeTime);\n        }\n\n        return ret % 1;\n      });\n    }\n  }, {\n    key: \"eomonth\",\n    value: function eomonth(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('EOMONTH'), function (dateNumber, numberOfMonthsToShift) {\n        var date = _this3.dateTimeHelper.numberToSimpleDate(dateNumber);\n\n        var ret = _this3.dateTimeHelper.dateToNumber(_this3.dateTimeHelper.endOfMonth(offsetMonth(date, numberOfMonthsToShift)));\n\n        ret = _this3.dateTimeHelper.getWithinBounds(ret);\n\n        if (ret === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"day\",\n    value: function day(ast, state) {\n      var _this4 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DAY'), function (dateNumber) {\n        return _this4.dateTimeHelper.numberToSimpleDate(dateNumber).day;\n      });\n    }\n  }, {\n    key: \"days\",\n    value: function days(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DAYS'), function (endDate, startDate) {\n        return Math.trunc(endDate) - Math.trunc(startDate);\n      });\n    }\n    /**\n     * Corresponds to MONTH(date)\n     *\n     * Returns the month of the year specified by a given date\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"month\",\n    value: function month(ast, state) {\n      var _this5 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('MONTH'), function (dateNumber) {\n        return _this5.dateTimeHelper.numberToSimpleDate(dateNumber).month;\n      });\n    }\n    /**\n     * Corresponds to YEAR(date)\n     *\n     * Returns the year specified by a given date\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"year\",\n    value: function year(ast, state) {\n      var _this6 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('YEAR'), function (dateNumber) {\n        return _this6.dateTimeHelper.numberToSimpleDate(dateNumber).year;\n      });\n    }\n  }, {\n    key: \"hour\",\n    value: function hour(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('HOUR'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).hours;\n      });\n    }\n  }, {\n    key: \"minute\",\n    value: function minute(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MINUTE'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).minutes;\n      });\n    }\n  }, {\n    key: \"second\",\n    value: function second(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SECOND'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).seconds;\n      });\n    }\n    /**\n     * Corresponds to TEXT(number, format)\n     *\n     * Tries to convert number to specified date format.\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"text\",\n    value: function text(ast, state) {\n      var _this7 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TEXT'), function (numberRepresentation, formatArg) {\n        return format(numberRepresentation, formatArg, _this7.config, _this7.dateTimeHelper);\n      });\n    }\n  }, {\n    key: \"weekday\",\n    value: function weekday(ast, state) {\n      var _this8 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WEEKDAY'), function (day, type) {\n        var absoluteDay = Math.floor(_this8.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n        if (type === 3) {\n          return (absoluteDay - 1) % 7;\n        }\n\n        var offset = weekdayOffsets.get(type);\n\n        if (offset === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n\n        return (absoluteDay - offset) % 7 + 1;\n      });\n    }\n  }, {\n    key: \"weeknum\",\n    value: function weeknum(ast, state) {\n      var _this9 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WEEKNUM'), function (day, type) {\n        var absoluteDay = Math.floor(_this9.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n        var date = _this9.dateTimeHelper.numberToSimpleDate(day);\n\n        var yearStart = _this9.dateTimeHelper.dateToNumber({\n          year: date.year,\n          month: 1,\n          day: 1\n        });\n\n        var yearStartAbsolute = _this9.dateTimeHelper.relativeNumberToAbsoluteNumber(yearStart);\n\n        if (type === 21) {\n          return _this9.isoweeknumCore(day);\n        }\n\n        var offset = weekdayOffsets.get(type);\n\n        if (offset === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n\n        return Math.floor((absoluteDay - offset) / 7) - Math.floor((yearStartAbsolute - offset) / 7) + 1;\n      });\n    }\n  }, {\n    key: \"isoweeknum\",\n    value: function isoweeknum(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('ISOWEEKNUM'), this.isoweeknumCore);\n    }\n  }, {\n    key: \"datevalue\",\n    value: function datevalue(ast, state) {\n      var _this10 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATEVALUE'), function (date) {\n        var _this10$dateTimeHelpe = _this10.dateTimeHelper.parseDateTimeFromConfigFormats(date),\n            dateTime = _this10$dateTimeHelpe.dateTime;\n\n        if (dateTime === undefined) {\n          return new CellError(ErrorType.VALUE, ErrorMessage.IncorrectDateTime);\n        }\n\n        if (!instanceOfSimpleDate(dateTime)) {\n          return 0;\n        }\n\n        return (instanceOfSimpleTime(dateTime) ? Math.trunc(timeToNumber(dateTime)) : 0) + _this10.dateTimeHelper.dateToNumber(dateTime);\n      });\n    }\n  }, {\n    key: \"timevalue\",\n    value: function timevalue(ast, state) {\n      var _this11 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TIMEVALUE'), function (date) {\n        var dateNumber = _this11.dateTimeHelper.dateStringToDateNumber(date);\n\n        if (dateNumber === undefined) {\n          return new CellError(ErrorType.VALUE, ErrorMessage.IncorrectDateTime);\n        }\n\n        return getRawValue(dateNumber) % 1;\n      });\n    }\n  }, {\n    key: \"now\",\n    value: function now(ast, state) {\n      var _this12 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NOW'), function () {\n        var now = new Date(Date.now());\n        return timeToNumber({\n          hours: now.getHours(),\n          minutes: now.getMinutes(),\n          seconds: now.getSeconds()\n        }) + _this12.dateTimeHelper.dateToNumber({\n          year: now.getFullYear(),\n          month: now.getMonth() + 1,\n          day: now.getDate()\n        });\n      });\n    }\n  }, {\n    key: \"today\",\n    value: function today(ast, state) {\n      var _this13 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TODAY'), function () {\n        var now = new Date(Date.now());\n        return _this13.dateTimeHelper.dateToNumber({\n          year: now.getFullYear(),\n          month: now.getMonth() + 1,\n          day: now.getDate()\n        });\n      });\n    }\n  }, {\n    key: \"edate\",\n    value: function edate(ast, state) {\n      var _this14 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('EDATE'), function (dateNumber, delta) {\n        var date = _this14.dateTimeHelper.numberToSimpleDate(dateNumber);\n\n        var newDate = truncateDayInMonth(offsetMonth(date, delta));\n\n        var ret = _this14.dateTimeHelper.dateToNumber(newDate);\n\n        ret = _this14.dateTimeHelper.getWithinBounds(ret);\n\n        if (ret === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"datedif\",\n    value: function datedif(ast, state) {\n      var _this15 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATEDIF'), function (startDate, endDate, unit) {\n        if (startDate > endDate) {\n          return new CellError(ErrorType.NUM, ErrorMessage.StartEndDate);\n        }\n\n        if (unit === 'D') {\n          return Math.floor(endDate) - Math.floor(startDate);\n        }\n\n        var start = _this15.dateTimeHelper.numberToSimpleDate(startDate);\n\n        var end = _this15.dateTimeHelper.numberToSimpleDate(endDate);\n\n        switch (unit) {\n          case 'M':\n            return (end.year - start.year) * 12 + (end.month - start.month) - (end.day < start.day ? 1 : 0);\n\n          case 'YM':\n            return (12 + (end.month - start.month) - (end.day < start.day ? 1 : 0)) % 12;\n\n          case 'Y':\n            if (end.month > start.month || end.month === start.month && end.day >= start.day) {\n              return end.year - start.year;\n            } else {\n              return end.year - start.year - 1;\n            }\n\n          case 'MD':\n            if (end.day >= start.day) {\n              return end.day - start.day;\n            } else {\n              var m = end.month === 1 ? 12 : end.month - 1;\n              var y = end.month === 1 ? end.year - 1 : end.year;\n              return _this15.dateTimeHelper.daysInMonth(y, m) + end.day - start.day;\n            }\n\n          case 'YD':\n            if (end.month > start.month || end.month === start.month && end.day >= start.day) {\n              return Math.floor(endDate) - _this15.dateTimeHelper.dateToNumber({\n                year: end.year,\n                month: start.month,\n                day: start.day\n              });\n            } else {\n              return Math.floor(endDate) - Math.floor(startDate) - 365 * (end.year - start.year - 1) - _this15.dateTimeHelper.leapYearsCount(end.year - 1) + _this15.dateTimeHelper.leapYearsCount(start.year);\n            }\n\n          default:\n            return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n      });\n    }\n  }, {\n    key: \"days360\",\n    value: function days360(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DAYS360'), this.days360Core);\n    }\n  }, {\n    key: \"yearfrac\",\n    value: function yearfrac(ast, state) {\n      var _this16 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('YEARFRAC'), function (startDate, endDate, mode) {\n        startDate = Math.trunc(startDate);\n        endDate = Math.trunc(endDate);\n\n        if (startDate > endDate) {\n          var _ref = [endDate, startDate];\n          startDate = _ref[0];\n          endDate = _ref[1];\n        }\n\n        switch (mode) {\n          case 0:\n            return _this16.days360Core(startDate, endDate, false) / 360;\n\n          case 1:\n            return (endDate - startDate) / _this16.dateTimeHelper.yearLengthForBasis(_this16.dateTimeHelper.numberToSimpleDate(startDate), _this16.dateTimeHelper.numberToSimpleDate(endDate));\n\n          case 2:\n            return (endDate - startDate) / 360;\n\n          case 3:\n            return (endDate - startDate) / 365;\n\n          case 4:\n            return _this16.days360Core(startDate, endDate, true) / 360;\n        }\n\n        throw new Error('Should not be reachable.');\n      });\n    }\n  }, {\n    key: \"interval\",\n    value: function interval(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('INTERVAL'), function (arg) {\n        arg = Math.trunc(arg);\n        var second = arg % 60;\n        arg = Math.trunc(arg / 60);\n        var minute = arg % 60;\n        arg = Math.trunc(arg / 60);\n        var hour = arg % 24;\n        arg = Math.trunc(arg / 24);\n        var day = arg % 30;\n        arg = Math.trunc(arg / 30);\n        var month = arg % 12;\n        var year = Math.trunc(arg / 12);\n        return 'P' + (year > 0 ? year + 'Y' : '') + (month > 0 ? month + 'M' : '') + (day > 0 ? day + 'D' : '') + 'T' + (hour > 0 ? hour + 'H' : '') + (minute > 0 ? minute + 'M' : '') + (second > 0 ? second + 'S' : '');\n      });\n    }\n  }, {\n    key: \"networkdays\",\n    value: function networkdays(ast, state) {\n      var _this17 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NETWORKDAYS'), function (start, end, holidays) {\n        return _this17.networkdayscore(start, end, 1, holidays);\n      });\n    }\n  }, {\n    key: \"networkdaysintl\",\n    value: function networkdaysintl(ast, state) {\n      var _this18 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NETWORKDAYS.INTL'), function (start, end, weekend, holidays) {\n        return _this18.networkdayscore(start, end, weekend, holidays);\n      });\n    }\n  }, {\n    key: \"workday\",\n    value: function workday(ast, state) {\n      var _this19 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WORKDAY'), function (start, end, holidays) {\n        return _this19.workdaycore(start, end, 1, holidays);\n      });\n    }\n  }, {\n    key: \"workdayintl\",\n    value: function workdayintl(ast, state) {\n      var _this20 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WORKDAY.INTL'), function (start, end, weekend, holidays) {\n        return _this20.workdaycore(start, end, weekend, holidays);\n      });\n    }\n  }, {\n    key: \"networkdayscore\",\n    value: function networkdayscore(start, end, weekend, holidays) {\n      start = Math.trunc(start);\n      end = Math.trunc(end);\n      var multiplier = 1;\n\n      if (start > end) {\n        var _ref2 = [end, start];\n        start = _ref2[0];\n        end = _ref2[1];\n        multiplier = -1;\n      }\n\n      var weekendPattern = computeWeekendPattern(weekend);\n\n      if (weekendPattern instanceof CellError) {\n        return weekendPattern;\n      }\n\n      var filteredHolidays = this.simpleRangeToFilteredHolidays(weekendPattern, holidays);\n\n      if (filteredHolidays instanceof CellError) {\n        return filteredHolidays;\n      }\n\n      return multiplier * this.countWorkdays(start, end, weekendPattern, filteredHolidays);\n    }\n  }, {\n    key: \"workdaycore\",\n    value: function workdaycore(start, delta, weekend, holidays) {\n      start = Math.trunc(start);\n      delta = Math.trunc(delta);\n      var weekendPattern = computeWeekendPattern(weekend);\n\n      if (weekendPattern instanceof CellError) {\n        return weekendPattern;\n      }\n\n      var filteredHolidays = this.simpleRangeToFilteredHolidays(weekendPattern, holidays);\n\n      if (filteredHolidays instanceof CellError) {\n        return filteredHolidays;\n      }\n\n      if (delta > 0) {\n        var upper = 1;\n\n        while (this.countWorkdays(start + 1, start + upper, weekendPattern, filteredHolidays) < delta) {\n          upper *= 2;\n        }\n\n        var lower = 1;\n\n        while (lower + 1 < upper) {\n          var mid = Math.trunc((lower + upper) / 2);\n\n          if (this.countWorkdays(start + 1, start + mid, weekendPattern, filteredHolidays) < delta) {\n            lower = mid;\n          } else {\n            upper = mid;\n          }\n        }\n\n        return start + upper;\n      } else if (delta < 0) {\n        delta *= -1;\n        var _upper = 1;\n\n        while (this.countWorkdays(start - _upper, start - 1, weekendPattern, filteredHolidays) < delta) {\n          _upper *= 2;\n        }\n\n        var _lower = 1;\n\n        while (_lower + 1 < _upper) {\n          var _mid = Math.trunc((_lower + _upper) / 2);\n\n          if (this.countWorkdays(start - _mid, start - 1, weekendPattern, filteredHolidays) < delta) {\n            _lower = _mid;\n          } else {\n            _upper = _mid;\n          }\n        }\n\n        return start - _upper;\n      } else {\n        return start;\n      }\n    }\n  }, {\n    key: \"countWorkdays\",\n    value: function countWorkdays(start, end, weekendPattern, sortedHolidays) {\n      var absoluteEnd = Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(end));\n      var absoluteStart = Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(start));\n      var ans = 0;\n\n      for (var i = 0; i < 7; i++) {\n        if (weekendPattern.charAt(i) === '0') {\n          ans += Math.floor((absoluteEnd + 6 - i) / 7);\n          ans -= Math.floor((absoluteStart - 1 + 6 - i) / 7);\n        }\n      }\n\n      ans -= lowerBound(end + 1, sortedHolidays) - lowerBound(start, sortedHolidays);\n      return ans;\n    }\n  }, {\n    key: \"simpleRangeToFilteredHolidays\",\n    value: function simpleRangeToFilteredHolidays(weekendPattern, holidays) {\n      var _this21 = this;\n\n      var _a;\n\n      var holidaysArr = (_a = holidays === null || holidays === void 0 ? void 0 : holidays.valuesFromTopLeftCorner()) !== null && _a !== void 0 ? _a : [];\n\n      var _iterator = _createForOfIteratorHelper(holidaysArr),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var val = _step.value;\n\n          if (val instanceof CellError) {\n            return val;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var processedHolidays = [];\n\n      var _iterator2 = _createForOfIteratorHelper(holidaysArr),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _val = _step2.value;\n\n          if (_val === EmptyValue) {\n            continue;\n          }\n\n          if (isExtendedNumber(_val)) {\n            processedHolidays.push(Math.trunc(getRawValue(_val)));\n          } else {\n            return new CellError(ErrorType.VALUE, ErrorMessage.WrongType);\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return _toConsumableArray(new Set(processedHolidays)).sort(function (a, b) {\n        return a - b;\n      }).filter(function (arg) {\n        var val = _this21.dateTimeHelper.relativeNumberToAbsoluteNumber(arg);\n\n        var i = (val - 1) % 7;\n        return weekendPattern.charAt(i) === '0';\n      });\n    }\n  }]);\n\n  return DateTimePlugin;\n}(FunctionPlugin);\nDateTimePlugin.implementedFunctions = {\n  'DATE': {\n    method: 'date',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'TIME': {\n    method: 'time',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_TIME\n  },\n  'MONTH': {\n    method: 'month',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'YEAR': {\n    method: 'year',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'HOUR': {\n    method: 'hour',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'MINUTE': {\n    method: 'minute',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'SECOND': {\n    method: 'second',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'TEXT': {\n    method: 'text',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.STRING\n    }]\n  },\n  'EOMONTH': {\n    method: 'eomonth',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'DAY': {\n    method: 'day',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DAYS': {\n    method: 'days',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'WEEKDAY': {\n    method: 'weekday',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 1\n    }]\n  },\n  'WEEKNUM': {\n    method: 'weeknum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 1\n    }]\n  },\n  'ISOWEEKNUM': {\n    method: 'isoweeknum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DATEVALUE': {\n    method: 'datevalue',\n    parameters: [{\n      argumentType: ArgumentTypes.STRING\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'TIMEVALUE': {\n    method: 'timevalue',\n    parameters: [{\n      argumentType: ArgumentTypes.STRING\n    }],\n    returnNumberType: NumberType.NUMBER_TIME\n  },\n  'NOW': {\n    method: 'now',\n    parameters: [],\n    isVolatile: true,\n    returnNumberType: NumberType.NUMBER_DATETIME\n  },\n  'TODAY': {\n    method: 'today',\n    parameters: [],\n    isVolatile: true,\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'EDATE': {\n    method: 'edate',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'DAYS360': {\n    method: 'days360',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.BOOLEAN,\n      defaultValue: false\n    }]\n  },\n  'DATEDIF': {\n    method: 'datedif',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.STRING\n    }]\n  },\n  'YEARFRAC': {\n    method: 'yearfrac',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      defaultValue: 0,\n      minValue: 0,\n      maxValue: 4\n    }]\n  },\n  'INTERVAL': {\n    method: 'interval',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'NETWORKDAYS': {\n    method: 'networkdays',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'NETWORKDAYS.INTL': {\n    method: 'networkdaysintl',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NOERROR,\n      defaultValue: 1\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'WORKDAY': {\n    method: 'workday',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'WORKDAY.INTL': {\n    method: 'workdayintl',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NOERROR,\n      defaultValue: 1\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  }\n};\n/**\n * Returns i such that:\n * sortedArray[i-1] < val <= sortedArray[i]\n *\n */\n\nfunction lowerBound(val, sortedArray) {\n  if (sortedArray.length === 0) {\n    return 0;\n  }\n\n  if (val <= sortedArray[0]) {\n    return 0;\n  }\n\n  if (sortedArray[sortedArray.length - 1] < val) {\n    return sortedArray.length;\n  }\n\n  var lower = 0; //sortedArray[lower] < val\n\n  var upper = sortedArray.length - 1; //sortedArray[upper] >= val\n\n  while (lower + 1 < upper) {\n    var mid = Math.floor((upper + lower) / 2);\n\n    if (sortedArray[mid] >= val) {\n      upper = mid;\n    } else {\n      lower = mid;\n    }\n  }\n\n  return upper;\n}\n\nfunction computeWeekendPattern(weekend) {\n  var _a;\n\n  if (typeof weekend !== 'number' && typeof weekend !== 'string') {\n    return new CellError(ErrorType.VALUE, ErrorMessage.WrongType);\n  }\n\n  if (typeof weekend === 'string') {\n    if (weekend.length !== 7 || !/^(0|1)*$/.test(weekend) || weekend === '1111111') {\n      return new CellError(ErrorType.NUM, ErrorMessage.WeekendString);\n    } else {\n      return weekend;\n    }\n  } else {\n    return (_a = workdayPatterns.get(weekend)) !== null && _a !== void 0 ? _a : new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n  }\n}\n\nvar weekdayOffsets = new Map([[1, 0], [2, 1], [11, 1], [12, 2], [13, 3], [14, 4], [15, 5], [16, 6], [17, 0]]);\nvar workdayPatterns = new Map([[1, '0000011'], [2, '1000001'], [3, '1100000'], [4, '0110000'], [5, '0011000'], [6, '0001100'], [7, '0000110'], [11, '0000001'], [12, '1000000'], [13, '0100000'], [14, '0010000'], [15, '0001000'], [16, '0000100'], [17, '0000010']]);","map":{"version":3,"sources":["/Users/mingjie.wang/Documents/Uber/MandA/demo-project/node_modules/hyperformula/es/interpreter/plugin/DateTimePlugin.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Array","from","isArray","_arrayLikeToArray","_createForOfIteratorHelper","o","allowArrayLike","it","length","i","F","s","n","done","value","e","_e2","f","normalCompletion","didErr","err","call","step","next","_e3","return","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","minLen","Object","toString","slice","name","test","len","arr2","_i","_arr","_n","_d","_s","_e","push","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","getPrototypeOf","CellError","ErrorType","instanceOfSimpleDate","instanceOfSimpleTime","numberToSimpleTime","offsetMonth","roundToNearestSecond","timeToNumber","toBasisEU","truncateDayInMonth","ErrorMessage","format","EmptyValue","getRawValue","isExtendedNumber","NumberType","ArgumentTypes","FunctionPlugin","DateTimePlugin","_FunctionPlugin","_super","_this","isoweeknumCore","day","absoluteDay","Math","floor","dateTimeHelper","relativeNumberToAbsoluteNumber","date","numberToSimpleDate","yearStart","dateToNumber","year","month","yearStartAbsolute","firstThursdayAbs","ret","days360Core","startDate","endDate","mode","start","end","nStart","nEnd","_this$dateTimeHelper$","toBasisUS","_this$dateTimeHelper$2","ast","state","_this2","runFunction","args","metadata","d","trunc","m","y","getEpochYearZero","delta","isValidDate","getWithinBounds","undefined","NUM","DateBounds","VALUE","InvalidDate","time","h","hours","minutes","seconds","NegativeTime","eomonth","_this3","dateNumber","numberOfMonthsToShift","endOfMonth","_this4","days","_this5","_this6","hour","timeNumber","minute","second","text","_this7","numberRepresentation","formatArg","config","weekday","_this8","type","offset","weekdayOffsets","get","BadMode","weeknum","_this9","isoweeknum","datevalue","_this10","_this10$dateTimeHelpe","parseDateTimeFromConfigFormats","dateTime","IncorrectDateTime","timevalue","_this11","dateStringToDateNumber","now","_this12","Date","getHours","getMinutes","getSeconds","getFullYear","getMonth","getDate","today","_this13","edate","_this14","newDate","datedif","_this15","unit","StartEndDate","daysInMonth","leapYearsCount","days360","yearfrac","_this16","_ref","yearLengthForBasis","Error","interval","arg","networkdays","_this17","holidays","networkdayscore","networkdaysintl","_this18","weekend","workday","_this19","workdaycore","workdayintl","_this20","multiplier","_ref2","weekendPattern","computeWeekendPattern","filteredHolidays","simpleRangeToFilteredHolidays","countWorkdays","upper","lower","mid","_upper","_lower","_mid","sortedHolidays","absoluteEnd","absoluteStart","ans","charAt","lowerBound","_this21","_a","holidaysArr","valuesFromTopLeftCorner","_iterator","_step","val","processedHolidays","_iterator2","_step2","_val","WrongType","Set","sort","a","b","filter","implementedFunctions","method","parameters","argumentType","NUMBER","returnNumberType","NUMBER_DATE","NUMBER_TIME","minValue","STRING","defaultValue","isVolatile","NUMBER_DATETIME","BOOLEAN","INTEGER","maxValue","RANGE","optionalArg","NOERROR","sortedArray","WeekendString","workdayPatterns","Map"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nimport \"core-js/modules/es.math.trunc.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\nimport { CellError, ErrorType } from '../../Cell';\nimport { instanceOfSimpleDate, instanceOfSimpleTime, numberToSimpleTime, offsetMonth, roundToNearestSecond, timeToNumber, toBasisEU, truncateDayInMonth } from '../../DateTimeHelper';\nimport { ErrorMessage } from '../../error-message';\nimport { format } from '../../format/format';\nimport { EmptyValue, getRawValue, isExtendedNumber, NumberType } from '../InterpreterValue';\nimport { ArgumentTypes, FunctionPlugin } from './FunctionPlugin';\n/**\n * Interpreter plugin containing date-specific functions\n */\n\nexport var DateTimePlugin = /*#__PURE__*/function (_FunctionPlugin) {\n  _inherits(DateTimePlugin, _FunctionPlugin);\n\n  var _super = _createSuper(DateTimePlugin);\n\n  function DateTimePlugin() {\n    var _this;\n\n    _classCallCheck(this, DateTimePlugin);\n\n    _this = _super.apply(this, arguments);\n\n    _this.isoweeknumCore = function (day) {\n      var absoluteDay = Math.floor(_this.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n      var date = _this.dateTimeHelper.numberToSimpleDate(day);\n\n      var yearStart = _this.dateTimeHelper.dateToNumber({\n        year: date.year,\n        month: 1,\n        day: 1\n      });\n\n      var yearStartAbsolute = _this.dateTimeHelper.relativeNumberToAbsoluteNumber(yearStart);\n\n      var firstThursdayAbs = yearStartAbsolute + ((4 - yearStartAbsolute) % 7 + 7) % 7;\n      var ret = Math.floor((absoluteDay - 1) / 7) - Math.floor((firstThursdayAbs - 1) / 7) + 1;\n\n      if (ret === 0) {\n        return _this.isoweeknumCore(day - 7) + 1;\n      }\n\n      return ret;\n    };\n\n    _this.days360Core = function (startDate, endDate, mode) {\n      var start = _this.dateTimeHelper.numberToSimpleDate(startDate);\n\n      var end = _this.dateTimeHelper.numberToSimpleDate(endDate);\n\n      var nStart, nEnd;\n\n      if (mode) {\n        nStart = toBasisEU(start);\n        nEnd = toBasisEU(end);\n      } else {\n        var _this$dateTimeHelper$ = _this.dateTimeHelper.toBasisUS(start, end);\n\n        var _this$dateTimeHelper$2 = _slicedToArray(_this$dateTimeHelper$, 2);\n\n        nStart = _this$dateTimeHelper$2[0];\n        nEnd = _this$dateTimeHelper$2[1];\n      }\n\n      return 360 * (nEnd.year - nStart.year) + 30 * (nEnd.month - nStart.month) + nEnd.day - nStart.day;\n    };\n\n    return _this;\n  }\n  /**\n   * Corresponds to DATE(year, month, day)\n   *\n   * Converts a provided year, month and day into date\n   *\n   * @param ast\n   * @param state\n   */\n\n\n  _createClass(DateTimePlugin, [{\n    key: \"date\",\n    value: function date(ast, state) {\n      var _this2 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATE'), function (year, month, day) {\n        var d = Math.trunc(day);\n        var m = Math.trunc(month);\n        var y = Math.trunc(year);\n\n        if (y < _this2.dateTimeHelper.getEpochYearZero()) {\n          y += _this2.dateTimeHelper.getEpochYearZero();\n        }\n\n        var delta = Math.floor((m - 1) / 12);\n        y += delta;\n        m -= delta * 12;\n        var date = {\n          year: y,\n          month: m,\n          day: 1\n        };\n\n        if (_this2.dateTimeHelper.isValidDate(date)) {\n          var ret = _this2.dateTimeHelper.dateToNumber(date) + (d - 1);\n          ret = _this2.dateTimeHelper.getWithinBounds(ret);\n\n          if (ret === undefined) {\n            return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n          }\n\n          return ret;\n        }\n\n        return new CellError(ErrorType.VALUE, ErrorMessage.InvalidDate);\n      });\n    }\n  }, {\n    key: \"time\",\n    value: function time(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('TIME'), function (h, m, s) {\n        var ret = timeToNumber({\n          hours: Math.trunc(h),\n          minutes: Math.trunc(m),\n          seconds: Math.trunc(s)\n        });\n\n        if (ret < 0) {\n          return new CellError(ErrorType.NUM, ErrorMessage.NegativeTime);\n        }\n\n        return ret % 1;\n      });\n    }\n  }, {\n    key: \"eomonth\",\n    value: function eomonth(ast, state) {\n      var _this3 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('EOMONTH'), function (dateNumber, numberOfMonthsToShift) {\n        var date = _this3.dateTimeHelper.numberToSimpleDate(dateNumber);\n\n        var ret = _this3.dateTimeHelper.dateToNumber(_this3.dateTimeHelper.endOfMonth(offsetMonth(date, numberOfMonthsToShift)));\n\n        ret = _this3.dateTimeHelper.getWithinBounds(ret);\n\n        if (ret === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"day\",\n    value: function day(ast, state) {\n      var _this4 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DAY'), function (dateNumber) {\n        return _this4.dateTimeHelper.numberToSimpleDate(dateNumber).day;\n      });\n    }\n  }, {\n    key: \"days\",\n    value: function days(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DAYS'), function (endDate, startDate) {\n        return Math.trunc(endDate) - Math.trunc(startDate);\n      });\n    }\n    /**\n     * Corresponds to MONTH(date)\n     *\n     * Returns the month of the year specified by a given date\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"month\",\n    value: function month(ast, state) {\n      var _this5 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('MONTH'), function (dateNumber) {\n        return _this5.dateTimeHelper.numberToSimpleDate(dateNumber).month;\n      });\n    }\n    /**\n     * Corresponds to YEAR(date)\n     *\n     * Returns the year specified by a given date\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"year\",\n    value: function year(ast, state) {\n      var _this6 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('YEAR'), function (dateNumber) {\n        return _this6.dateTimeHelper.numberToSimpleDate(dateNumber).year;\n      });\n    }\n  }, {\n    key: \"hour\",\n    value: function hour(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('HOUR'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).hours;\n      });\n    }\n  }, {\n    key: \"minute\",\n    value: function minute(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('MINUTE'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).minutes;\n      });\n    }\n  }, {\n    key: \"second\",\n    value: function second(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('SECOND'), function (timeNumber) {\n        return numberToSimpleTime(roundToNearestSecond(timeNumber) % 1).seconds;\n      });\n    }\n    /**\n     * Corresponds to TEXT(number, format)\n     *\n     * Tries to convert number to specified date format.\n     *\n     * @param ast\n     * @param state\n     */\n\n  }, {\n    key: \"text\",\n    value: function text(ast, state) {\n      var _this7 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TEXT'), function (numberRepresentation, formatArg) {\n        return format(numberRepresentation, formatArg, _this7.config, _this7.dateTimeHelper);\n      });\n    }\n  }, {\n    key: \"weekday\",\n    value: function weekday(ast, state) {\n      var _this8 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WEEKDAY'), function (day, type) {\n        var absoluteDay = Math.floor(_this8.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n        if (type === 3) {\n          return (absoluteDay - 1) % 7;\n        }\n\n        var offset = weekdayOffsets.get(type);\n\n        if (offset === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n\n        return (absoluteDay - offset) % 7 + 1;\n      });\n    }\n  }, {\n    key: \"weeknum\",\n    value: function weeknum(ast, state) {\n      var _this9 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WEEKNUM'), function (day, type) {\n        var absoluteDay = Math.floor(_this9.dateTimeHelper.relativeNumberToAbsoluteNumber(day));\n\n        var date = _this9.dateTimeHelper.numberToSimpleDate(day);\n\n        var yearStart = _this9.dateTimeHelper.dateToNumber({\n          year: date.year,\n          month: 1,\n          day: 1\n        });\n\n        var yearStartAbsolute = _this9.dateTimeHelper.relativeNumberToAbsoluteNumber(yearStart);\n\n        if (type === 21) {\n          return _this9.isoweeknumCore(day);\n        }\n\n        var offset = weekdayOffsets.get(type);\n\n        if (offset === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n\n        return Math.floor((absoluteDay - offset) / 7) - Math.floor((yearStartAbsolute - offset) / 7) + 1;\n      });\n    }\n  }, {\n    key: \"isoweeknum\",\n    value: function isoweeknum(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('ISOWEEKNUM'), this.isoweeknumCore);\n    }\n  }, {\n    key: \"datevalue\",\n    value: function datevalue(ast, state) {\n      var _this10 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATEVALUE'), function (date) {\n        var _this10$dateTimeHelpe = _this10.dateTimeHelper.parseDateTimeFromConfigFormats(date),\n            dateTime = _this10$dateTimeHelpe.dateTime;\n\n        if (dateTime === undefined) {\n          return new CellError(ErrorType.VALUE, ErrorMessage.IncorrectDateTime);\n        }\n\n        if (!instanceOfSimpleDate(dateTime)) {\n          return 0;\n        }\n\n        return (instanceOfSimpleTime(dateTime) ? Math.trunc(timeToNumber(dateTime)) : 0) + _this10.dateTimeHelper.dateToNumber(dateTime);\n      });\n    }\n  }, {\n    key: \"timevalue\",\n    value: function timevalue(ast, state) {\n      var _this11 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TIMEVALUE'), function (date) {\n        var dateNumber = _this11.dateTimeHelper.dateStringToDateNumber(date);\n\n        if (dateNumber === undefined) {\n          return new CellError(ErrorType.VALUE, ErrorMessage.IncorrectDateTime);\n        }\n\n        return getRawValue(dateNumber) % 1;\n      });\n    }\n  }, {\n    key: \"now\",\n    value: function now(ast, state) {\n      var _this12 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NOW'), function () {\n        var now = new Date(Date.now());\n        return timeToNumber({\n          hours: now.getHours(),\n          minutes: now.getMinutes(),\n          seconds: now.getSeconds()\n        }) + _this12.dateTimeHelper.dateToNumber({\n          year: now.getFullYear(),\n          month: now.getMonth() + 1,\n          day: now.getDate()\n        });\n      });\n    }\n  }, {\n    key: \"today\",\n    value: function today(ast, state) {\n      var _this13 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('TODAY'), function () {\n        var now = new Date(Date.now());\n        return _this13.dateTimeHelper.dateToNumber({\n          year: now.getFullYear(),\n          month: now.getMonth() + 1,\n          day: now.getDate()\n        });\n      });\n    }\n  }, {\n    key: \"edate\",\n    value: function edate(ast, state) {\n      var _this14 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('EDATE'), function (dateNumber, delta) {\n        var date = _this14.dateTimeHelper.numberToSimpleDate(dateNumber);\n\n        var newDate = truncateDayInMonth(offsetMonth(date, delta));\n\n        var ret = _this14.dateTimeHelper.dateToNumber(newDate);\n\n        ret = _this14.dateTimeHelper.getWithinBounds(ret);\n\n        if (ret === undefined) {\n          return new CellError(ErrorType.NUM, ErrorMessage.DateBounds);\n        }\n\n        return ret;\n      });\n    }\n  }, {\n    key: \"datedif\",\n    value: function datedif(ast, state) {\n      var _this15 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('DATEDIF'), function (startDate, endDate, unit) {\n        if (startDate > endDate) {\n          return new CellError(ErrorType.NUM, ErrorMessage.StartEndDate);\n        }\n\n        if (unit === 'D') {\n          return Math.floor(endDate) - Math.floor(startDate);\n        }\n\n        var start = _this15.dateTimeHelper.numberToSimpleDate(startDate);\n\n        var end = _this15.dateTimeHelper.numberToSimpleDate(endDate);\n\n        switch (unit) {\n          case 'M':\n            return (end.year - start.year) * 12 + (end.month - start.month) - (end.day < start.day ? 1 : 0);\n\n          case 'YM':\n            return (12 + (end.month - start.month) - (end.day < start.day ? 1 : 0)) % 12;\n\n          case 'Y':\n            if (end.month > start.month || end.month === start.month && end.day >= start.day) {\n              return end.year - start.year;\n            } else {\n              return end.year - start.year - 1;\n            }\n\n          case 'MD':\n            if (end.day >= start.day) {\n              return end.day - start.day;\n            } else {\n              var m = end.month === 1 ? 12 : end.month - 1;\n              var y = end.month === 1 ? end.year - 1 : end.year;\n              return _this15.dateTimeHelper.daysInMonth(y, m) + end.day - start.day;\n            }\n\n          case 'YD':\n            if (end.month > start.month || end.month === start.month && end.day >= start.day) {\n              return Math.floor(endDate) - _this15.dateTimeHelper.dateToNumber({\n                year: end.year,\n                month: start.month,\n                day: start.day\n              });\n            } else {\n              return Math.floor(endDate) - Math.floor(startDate) - 365 * (end.year - start.year - 1) - _this15.dateTimeHelper.leapYearsCount(end.year - 1) + _this15.dateTimeHelper.leapYearsCount(start.year);\n            }\n\n          default:\n            return new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n        }\n      });\n    }\n  }, {\n    key: \"days360\",\n    value: function days360(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('DAYS360'), this.days360Core);\n    }\n  }, {\n    key: \"yearfrac\",\n    value: function yearfrac(ast, state) {\n      var _this16 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('YEARFRAC'), function (startDate, endDate, mode) {\n        startDate = Math.trunc(startDate);\n        endDate = Math.trunc(endDate);\n\n        if (startDate > endDate) {\n          var _ref = [endDate, startDate];\n          startDate = _ref[0];\n          endDate = _ref[1];\n        }\n\n        switch (mode) {\n          case 0:\n            return _this16.days360Core(startDate, endDate, false) / 360;\n\n          case 1:\n            return (endDate - startDate) / _this16.dateTimeHelper.yearLengthForBasis(_this16.dateTimeHelper.numberToSimpleDate(startDate), _this16.dateTimeHelper.numberToSimpleDate(endDate));\n\n          case 2:\n            return (endDate - startDate) / 360;\n\n          case 3:\n            return (endDate - startDate) / 365;\n\n          case 4:\n            return _this16.days360Core(startDate, endDate, true) / 360;\n        }\n\n        throw new Error('Should not be reachable.');\n      });\n    }\n  }, {\n    key: \"interval\",\n    value: function interval(ast, state) {\n      return this.runFunction(ast.args, state, this.metadata('INTERVAL'), function (arg) {\n        arg = Math.trunc(arg);\n        var second = arg % 60;\n        arg = Math.trunc(arg / 60);\n        var minute = arg % 60;\n        arg = Math.trunc(arg / 60);\n        var hour = arg % 24;\n        arg = Math.trunc(arg / 24);\n        var day = arg % 30;\n        arg = Math.trunc(arg / 30);\n        var month = arg % 12;\n        var year = Math.trunc(arg / 12);\n        return 'P' + (year > 0 ? year + 'Y' : '') + (month > 0 ? month + 'M' : '') + (day > 0 ? day + 'D' : '') + 'T' + (hour > 0 ? hour + 'H' : '') + (minute > 0 ? minute + 'M' : '') + (second > 0 ? second + 'S' : '');\n      });\n    }\n  }, {\n    key: \"networkdays\",\n    value: function networkdays(ast, state) {\n      var _this17 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NETWORKDAYS'), function (start, end, holidays) {\n        return _this17.networkdayscore(start, end, 1, holidays);\n      });\n    }\n  }, {\n    key: \"networkdaysintl\",\n    value: function networkdaysintl(ast, state) {\n      var _this18 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('NETWORKDAYS.INTL'), function (start, end, weekend, holidays) {\n        return _this18.networkdayscore(start, end, weekend, holidays);\n      });\n    }\n  }, {\n    key: \"workday\",\n    value: function workday(ast, state) {\n      var _this19 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WORKDAY'), function (start, end, holidays) {\n        return _this19.workdaycore(start, end, 1, holidays);\n      });\n    }\n  }, {\n    key: \"workdayintl\",\n    value: function workdayintl(ast, state) {\n      var _this20 = this;\n\n      return this.runFunction(ast.args, state, this.metadata('WORKDAY.INTL'), function (start, end, weekend, holidays) {\n        return _this20.workdaycore(start, end, weekend, holidays);\n      });\n    }\n  }, {\n    key: \"networkdayscore\",\n    value: function networkdayscore(start, end, weekend, holidays) {\n      start = Math.trunc(start);\n      end = Math.trunc(end);\n      var multiplier = 1;\n\n      if (start > end) {\n        var _ref2 = [end, start];\n        start = _ref2[0];\n        end = _ref2[1];\n        multiplier = -1;\n      }\n\n      var weekendPattern = computeWeekendPattern(weekend);\n\n      if (weekendPattern instanceof CellError) {\n        return weekendPattern;\n      }\n\n      var filteredHolidays = this.simpleRangeToFilteredHolidays(weekendPattern, holidays);\n\n      if (filteredHolidays instanceof CellError) {\n        return filteredHolidays;\n      }\n\n      return multiplier * this.countWorkdays(start, end, weekendPattern, filteredHolidays);\n    }\n  }, {\n    key: \"workdaycore\",\n    value: function workdaycore(start, delta, weekend, holidays) {\n      start = Math.trunc(start);\n      delta = Math.trunc(delta);\n      var weekendPattern = computeWeekendPattern(weekend);\n\n      if (weekendPattern instanceof CellError) {\n        return weekendPattern;\n      }\n\n      var filteredHolidays = this.simpleRangeToFilteredHolidays(weekendPattern, holidays);\n\n      if (filteredHolidays instanceof CellError) {\n        return filteredHolidays;\n      }\n\n      if (delta > 0) {\n        var upper = 1;\n\n        while (this.countWorkdays(start + 1, start + upper, weekendPattern, filteredHolidays) < delta) {\n          upper *= 2;\n        }\n\n        var lower = 1;\n\n        while (lower + 1 < upper) {\n          var mid = Math.trunc((lower + upper) / 2);\n\n          if (this.countWorkdays(start + 1, start + mid, weekendPattern, filteredHolidays) < delta) {\n            lower = mid;\n          } else {\n            upper = mid;\n          }\n        }\n\n        return start + upper;\n      } else if (delta < 0) {\n        delta *= -1;\n        var _upper = 1;\n\n        while (this.countWorkdays(start - _upper, start - 1, weekendPattern, filteredHolidays) < delta) {\n          _upper *= 2;\n        }\n\n        var _lower = 1;\n\n        while (_lower + 1 < _upper) {\n          var _mid = Math.trunc((_lower + _upper) / 2);\n\n          if (this.countWorkdays(start - _mid, start - 1, weekendPattern, filteredHolidays) < delta) {\n            _lower = _mid;\n          } else {\n            _upper = _mid;\n          }\n        }\n\n        return start - _upper;\n      } else {\n        return start;\n      }\n    }\n  }, {\n    key: \"countWorkdays\",\n    value: function countWorkdays(start, end, weekendPattern, sortedHolidays) {\n      var absoluteEnd = Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(end));\n      var absoluteStart = Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(start));\n      var ans = 0;\n\n      for (var i = 0; i < 7; i++) {\n        if (weekendPattern.charAt(i) === '0') {\n          ans += Math.floor((absoluteEnd + 6 - i) / 7);\n          ans -= Math.floor((absoluteStart - 1 + 6 - i) / 7);\n        }\n      }\n\n      ans -= lowerBound(end + 1, sortedHolidays) - lowerBound(start, sortedHolidays);\n      return ans;\n    }\n  }, {\n    key: \"simpleRangeToFilteredHolidays\",\n    value: function simpleRangeToFilteredHolidays(weekendPattern, holidays) {\n      var _this21 = this;\n\n      var _a;\n\n      var holidaysArr = (_a = holidays === null || holidays === void 0 ? void 0 : holidays.valuesFromTopLeftCorner()) !== null && _a !== void 0 ? _a : [];\n\n      var _iterator = _createForOfIteratorHelper(holidaysArr),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var val = _step.value;\n\n          if (val instanceof CellError) {\n            return val;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var processedHolidays = [];\n\n      var _iterator2 = _createForOfIteratorHelper(holidaysArr),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _val = _step2.value;\n\n          if (_val === EmptyValue) {\n            continue;\n          }\n\n          if (isExtendedNumber(_val)) {\n            processedHolidays.push(Math.trunc(getRawValue(_val)));\n          } else {\n            return new CellError(ErrorType.VALUE, ErrorMessage.WrongType);\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      return _toConsumableArray(new Set(processedHolidays)).sort(function (a, b) {\n        return a - b;\n      }).filter(function (arg) {\n        var val = _this21.dateTimeHelper.relativeNumberToAbsoluteNumber(arg);\n\n        var i = (val - 1) % 7;\n        return weekendPattern.charAt(i) === '0';\n      });\n    }\n  }]);\n\n  return DateTimePlugin;\n}(FunctionPlugin);\nDateTimePlugin.implementedFunctions = {\n  'DATE': {\n    method: 'date',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'TIME': {\n    method: 'time',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_TIME\n  },\n  'MONTH': {\n    method: 'month',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'YEAR': {\n    method: 'year',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'HOUR': {\n    method: 'hour',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'MINUTE': {\n    method: 'minute',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'SECOND': {\n    method: 'second',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'TEXT': {\n    method: 'text',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.STRING\n    }]\n  },\n  'EOMONTH': {\n    method: 'eomonth',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'DAY': {\n    method: 'day',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DAYS': {\n    method: 'days',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'WEEKDAY': {\n    method: 'weekday',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 1\n    }]\n  },\n  'WEEKNUM': {\n    method: 'weeknum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      defaultValue: 1\n    }]\n  },\n  'ISOWEEKNUM': {\n    method: 'isoweeknum',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'DATEVALUE': {\n    method: 'datevalue',\n    parameters: [{\n      argumentType: ArgumentTypes.STRING\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'TIMEVALUE': {\n    method: 'timevalue',\n    parameters: [{\n      argumentType: ArgumentTypes.STRING\n    }],\n    returnNumberType: NumberType.NUMBER_TIME\n  },\n  'NOW': {\n    method: 'now',\n    parameters: [],\n    isVolatile: true,\n    returnNumberType: NumberType.NUMBER_DATETIME\n  },\n  'TODAY': {\n    method: 'today',\n    parameters: [],\n    isVolatile: true,\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'EDATE': {\n    method: 'edate',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }],\n    returnNumberType: NumberType.NUMBER_DATE\n  },\n  'DAYS360': {\n    method: 'days360',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.BOOLEAN,\n      defaultValue: false\n    }]\n  },\n  'DATEDIF': {\n    method: 'datedif',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.STRING\n    }]\n  },\n  'YEARFRAC': {\n    method: 'yearfrac',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.INTEGER,\n      defaultValue: 0,\n      minValue: 0,\n      maxValue: 4\n    }]\n  },\n  'INTERVAL': {\n    method: 'interval',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }]\n  },\n  'NETWORKDAYS': {\n    method: 'networkdays',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'NETWORKDAYS.INTL': {\n    method: 'networkdaysintl',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NOERROR,\n      defaultValue: 1\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'WORKDAY': {\n    method: 'workday',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  },\n  'WORKDAY.INTL': {\n    method: 'workdayintl',\n    parameters: [{\n      argumentType: ArgumentTypes.NUMBER,\n      minValue: 0\n    }, {\n      argumentType: ArgumentTypes.NUMBER\n    }, {\n      argumentType: ArgumentTypes.NOERROR,\n      defaultValue: 1\n    }, {\n      argumentType: ArgumentTypes.RANGE,\n      optionalArg: true\n    }]\n  }\n};\n/**\n * Returns i such that:\n * sortedArray[i-1] < val <= sortedArray[i]\n *\n */\n\nfunction lowerBound(val, sortedArray) {\n  if (sortedArray.length === 0) {\n    return 0;\n  }\n\n  if (val <= sortedArray[0]) {\n    return 0;\n  }\n\n  if (sortedArray[sortedArray.length - 1] < val) {\n    return sortedArray.length;\n  }\n\n  var lower = 0; //sortedArray[lower] < val\n\n  var upper = sortedArray.length - 1; //sortedArray[upper] >= val\n\n  while (lower + 1 < upper) {\n    var mid = Math.floor((upper + lower) / 2);\n\n    if (sortedArray[mid] >= val) {\n      upper = mid;\n    } else {\n      lower = mid;\n    }\n  }\n\n  return upper;\n}\n\nfunction computeWeekendPattern(weekend) {\n  var _a;\n\n  if (typeof weekend !== 'number' && typeof weekend !== 'string') {\n    return new CellError(ErrorType.VALUE, ErrorMessage.WrongType);\n  }\n\n  if (typeof weekend === 'string') {\n    if (weekend.length !== 7 || !/^(0|1)*$/.test(weekend) || weekend === '1111111') {\n      return new CellError(ErrorType.NUM, ErrorMessage.WeekendString);\n    } else {\n      return weekend;\n    }\n  } else {\n    return (_a = workdayPatterns.get(weekend)) !== null && _a !== void 0 ? _a : new CellError(ErrorType.NUM, ErrorMessage.BadMode);\n  }\n}\n\nvar weekdayOffsets = new Map([[1, 0], [2, 1], [11, 1], [12, 2], [13, 3], [14, 4], [15, 5], [16, 6], [17, 0]]);\nvar workdayPatterns = new Map([[1, '0000011'], [2, '1000001'], [3, '1100000'], [4, '0110000'], [5, '0011000'], [6, '0001100'], [7, '0000110'], [11, '0000001'], [12, '1000000'], [13, '0100000'], [14, '0010000'], [15, '0001000'], [16, '0000100'], [17, '0000010']]);"]},"metadata":{},"sourceType":"module"}