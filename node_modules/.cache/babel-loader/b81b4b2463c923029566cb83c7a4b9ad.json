{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mingjie.wang/Documents/Uber/MandA/demo-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport \"regenerator-runtime/runtime.js\";\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e2) {\n          throw _e2;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e3) {\n      didErr = true;\n      err = _e3;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\nimport { AliasAlreadyExisting, FunctionPluginValidationError, ProtectedFunctionError } from '../errors';\nimport { HyperFormula } from '../HyperFormula';\nimport { VersionPlugin } from './plugin/VersionPlugin';\n\nfunction validateAndReturnMetadataFromName(functionId, plugin) {\n  var _a;\n\n  var entry = plugin.implementedFunctions[functionId];\n  var key = (_a = plugin.aliases) === null || _a === void 0 ? void 0 : _a[functionId];\n\n  if (key !== undefined) {\n    if (entry !== undefined) {\n      throw new AliasAlreadyExisting(functionId, plugin.name);\n    }\n\n    entry = plugin.implementedFunctions[key];\n  }\n\n  if (entry === undefined) {\n    throw FunctionPluginValidationError.functionNotDeclaredInPlugin(functionId, plugin.name);\n  }\n\n  return entry;\n}\n\nexport var FunctionRegistry = /*#__PURE__*/function () {\n  function FunctionRegistry(config) {\n    var _this = this;\n\n    _classCallCheck(this, FunctionRegistry);\n\n    this.config = config;\n    this.functions = new Map();\n    this.arraySizeFunctions = new Map();\n    this.volatileFunctions = new Set();\n    this.arrayFunctions = new Set();\n    this.structuralChangeFunctions = new Set();\n    this.functionsWhichDoesNotNeedArgumentsToBeComputed = new Set();\n    this.functionsMetadata = new Map();\n\n    this.doesFunctionNeedArgumentToBeComputed = function (functionId) {\n      return _this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(functionId);\n    };\n\n    this.isFunctionVolatile = function (functionId) {\n      return _this.volatileFunctions.has(functionId);\n    };\n\n    this.isArrayFunction = function (functionId) {\n      return _this.arrayFunctions.has(functionId);\n    };\n\n    this.isFunctionDependentOnSheetStructureChange = function (functionId) {\n      return _this.structuralChangeFunctions.has(functionId);\n    };\n\n    if (config.functionPlugins.length > 0) {\n      this.instancePlugins = new Map();\n\n      var _iterator = _createForOfIteratorHelper(config.functionPlugins),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var plugin = _step.value;\n          FunctionRegistry.loadPluginFunctions(plugin, this.instancePlugins);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    } else {\n      this.instancePlugins = new Map(FunctionRegistry.plugins);\n    }\n\n    var _iterator2 = _createForOfIteratorHelper(FunctionRegistry.protectedFunctions()),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var _step2$value = _slicedToArray(_step2.value, 2),\n            functionId = _step2$value[0],\n            _plugin = _step2$value[1];\n\n        FunctionRegistry.loadFunctionUnprotected(_plugin, functionId, this.instancePlugins);\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    var _iterator3 = _createForOfIteratorHelper(this.instancePlugins.entries()),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var _step3$value = _slicedToArray(_step3.value, 2),\n            _functionId = _step3$value[0],\n            _plugin2 = _step3$value[1];\n\n        this.categorizeFunction(_functionId, validateAndReturnMetadataFromName(_functionId, _plugin2));\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n  }\n\n  _createClass(FunctionRegistry, [{\n    key: \"initializePlugins\",\n    value: function initializePlugins(interpreter) {\n      var _this2 = this; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n      var instances = [];\n\n      var _iterator4 = _createForOfIteratorHelper(this.instancePlugins.entries()),\n          _step4;\n\n      try {\n        var _loop = function _loop() {\n          var _step4$value = _slicedToArray(_step4.value, 2),\n              functionId = _step4$value[0],\n              plugin = _step4$value[1];\n\n          var foundPluginInstance = instances.find(function (pluginInstance) {\n            return pluginInstance instanceof plugin;\n          });\n\n          if (foundPluginInstance === undefined) {\n            foundPluginInstance = new plugin(interpreter);\n            instances.push(foundPluginInstance);\n          }\n\n          var metadata = validateAndReturnMetadataFromName(functionId, plugin);\n          var methodName = metadata.method;\n\n          _this2.functions.set(functionId, [methodName, foundPluginInstance]);\n\n          var arraySizeMethodName = metadata.arraySizeMethod;\n\n          if (arraySizeMethodName !== undefined) {\n            _this2.arraySizeFunctions.set(functionId, [arraySizeMethodName, foundPluginInstance]);\n          }\n        };\n\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          _loop();\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }, {\n    key: \"getFunctionPlugin\",\n    value: function getFunctionPlugin(functionId) {\n      if (FunctionRegistry.functionIsProtected(functionId)) {\n        return undefined;\n      }\n\n      return this.instancePlugins.get(functionId);\n    }\n  }, {\n    key: \"getFunction\",\n    value: function getFunction(functionId) {\n      var pluginEntry = this.functions.get(functionId);\n\n      if (pluginEntry !== undefined && this.config.translationPackage.isFunctionTranslated(functionId)) {\n        var _pluginEntry = _slicedToArray(pluginEntry, 2),\n            pluginFunction = _pluginEntry[0],\n            pluginInstance = _pluginEntry[1];\n\n        return function (ast, state) {\n          return pluginInstance[pluginFunction](ast, state);\n        };\n      } else {\n        return undefined;\n      }\n    }\n  }, {\n    key: \"getArraySizeFunction\",\n    value: function getArraySizeFunction(functionId) {\n      var pluginEntry = this.arraySizeFunctions.get(functionId);\n\n      if (pluginEntry !== undefined && this.config.translationPackage.isFunctionTranslated(functionId)) {\n        var _pluginEntry2 = _slicedToArray(pluginEntry, 2),\n            pluginArraySizeFunction = _pluginEntry2[0],\n            pluginInstance = _pluginEntry2[1];\n\n        return function (ast, state) {\n          return pluginInstance[pluginArraySizeFunction](ast, state);\n        };\n      } else {\n        return undefined;\n      }\n    }\n  }, {\n    key: \"getMetadata\",\n    value: function getMetadata(functionId) {\n      return this.functionsMetadata.get(functionId);\n    }\n  }, {\n    key: \"getPlugins\",\n    value: function getPlugins() {\n      var plugins = new Set();\n\n      var _iterator5 = _createForOfIteratorHelper(this.instancePlugins),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _step5$value = _slicedToArray(_step5.value, 2),\n              functionId = _step5$value[0],\n              plugin = _step5$value[1];\n\n          if (!FunctionRegistry.functionIsProtected(functionId)) {\n            plugins.add(plugin);\n          }\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      return Array.from(plugins);\n    }\n  }, {\n    key: \"getRegisteredFunctionIds\",\n    value: function getRegisteredFunctionIds() {\n      return Array.from(this.functions.keys());\n    }\n  }, {\n    key: \"categorizeFunction\",\n    value: function categorizeFunction(functionId, functionMetadata) {\n      if (functionMetadata.isVolatile) {\n        this.volatileFunctions.add(functionId);\n      }\n\n      if (functionMetadata.arrayFunction) {\n        this.arrayFunctions.add(functionId);\n      }\n\n      if (functionMetadata.doesNotNeedArgumentsToBeComputed) {\n        this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(functionId);\n      }\n\n      if (functionMetadata.isDependentOnSheetStructureChange) {\n        this.structuralChangeFunctions.add(functionId);\n      }\n\n      this.functionsMetadata.set(functionId, functionMetadata);\n    }\n  }], [{\n    key: \"registerFunctionPlugin\",\n    value: function registerFunctionPlugin(plugin, translations) {\n      this.loadPluginFunctions(plugin, this.plugins);\n\n      if (translations !== undefined) {\n        this.loadTranslations(translations);\n      }\n    }\n  }, {\n    key: \"registerFunction\",\n    value: function registerFunction(functionId, plugin, translations) {\n      this.loadPluginFunction(plugin, functionId, this.plugins);\n\n      if (translations !== undefined) {\n        this.loadTranslations(translations);\n      }\n    }\n  }, {\n    key: \"unregisterFunction\",\n    value: function unregisterFunction(functionId) {\n      if (this.functionIsProtected(functionId)) {\n        throw ProtectedFunctionError.cannotUnregisterFunctionWithId(functionId);\n      }\n\n      this.plugins.delete(functionId);\n    }\n  }, {\n    key: \"unregisterFunctionPlugin\",\n    value: function unregisterFunctionPlugin(plugin) {\n      var _iterator6 = _createForOfIteratorHelper(this.protectedPlugins()),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var protectedPlugin = _step6.value;\n\n          if (protectedPlugin === plugin) {\n            throw ProtectedFunctionError.cannotUnregisterProtectedPlugin();\n          }\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n\n      var _iterator7 = _createForOfIteratorHelper(this.plugins.entries()),\n          _step7;\n\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var _step7$value = _slicedToArray(_step7.value, 2),\n              functionId = _step7$value[0],\n              registeredPlugin = _step7$value[1];\n\n          if (registeredPlugin === plugin) {\n            this.plugins.delete(functionId);\n          }\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n  }, {\n    key: \"unregisterAll\",\n    value: function unregisterAll() {\n      this.plugins.clear();\n    }\n  }, {\n    key: \"getRegisteredFunctionIds\",\n    value: function getRegisteredFunctionIds() {\n      return [].concat(_toConsumableArray(Array.from(this.plugins.keys())), _toConsumableArray(Array.from(this._protectedPlugins.keys())));\n    }\n  }, {\n    key: \"getPlugins\",\n    value: function getPlugins() {\n      return Array.from(new Set(this.plugins.values()).values());\n    }\n  }, {\n    key: \"getFunctionPlugin\",\n    value: function getFunctionPlugin(functionId) {\n      if (this.functionIsProtected(functionId)) {\n        return undefined;\n      } else {\n        return this.plugins.get(functionId);\n      }\n    }\n  }, {\n    key: \"loadTranslations\",\n    value: function loadTranslations(translations) {\n      var registeredLanguages = new Set(HyperFormula.getRegisteredLanguagesCodes());\n      Object.keys(translations).forEach(function (code) {\n        if (registeredLanguages.has(code)) {\n          HyperFormula.getLanguage(code).extendFunctions(translations[code]);\n        }\n      });\n    }\n  }, {\n    key: \"loadPluginFunctions\",\n    value: function loadPluginFunctions(plugin, registry) {\n      var _this3 = this;\n\n      Object.keys(plugin.implementedFunctions).forEach(function (functionName) {\n        _this3.loadPluginFunction(plugin, functionName, registry);\n      });\n\n      if (plugin.aliases !== undefined) {\n        Object.keys(plugin.aliases).forEach(function (functionName) {\n          _this3.loadPluginFunction(plugin, functionName, registry);\n        });\n      }\n    }\n  }, {\n    key: \"loadPluginFunction\",\n    value: function loadPluginFunction(plugin, functionId, registry) {\n      if (this.functionIsProtected(functionId)) {\n        throw ProtectedFunctionError.cannotRegisterFunctionWithId(functionId);\n      } else {\n        this.loadFunctionUnprotected(plugin, functionId, registry);\n      }\n    }\n  }, {\n    key: \"loadFunctionUnprotected\",\n    value: function loadFunctionUnprotected(plugin, functionId, registry) {\n      var methodName = validateAndReturnMetadataFromName(functionId, plugin).method;\n\n      if (Object.prototype.hasOwnProperty.call(plugin.prototype, methodName)) {\n        registry.set(functionId, plugin);\n      } else {\n        throw FunctionPluginValidationError.functionMethodNotFound(methodName, plugin.name);\n      }\n    }\n  }, {\n    key: \"functionIsProtected\",\n    value: function functionIsProtected(functionId) {\n      return this._protectedPlugins.has(functionId);\n    }\n  }, {\n    key: \"protectedFunctions\",\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function protectedFunctions() {\n      var _iterator8, _step8, _step8$value, functionId, plugin;\n\n      return _regeneratorRuntime.wrap(function protectedFunctions$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _iterator8 = _createForOfIteratorHelper(this._protectedPlugins);\n              _context.prev = 1;\n\n              _iterator8.s();\n\n            case 3:\n              if ((_step8 = _iterator8.n()).done) {\n                _context.next = 10;\n                break;\n              }\n\n              _step8$value = _slicedToArray(_step8.value, 2), functionId = _step8$value[0], plugin = _step8$value[1];\n\n              if (!(plugin !== undefined)) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 8;\n              return [functionId, plugin];\n\n            case 8:\n              _context.next = 3;\n              break;\n\n            case 10:\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](1);\n\n              _iterator8.e(_context.t0);\n\n            case 15:\n              _context.prev = 15;\n\n              _iterator8.f();\n\n              return _context.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, protectedFunctions, this, [[1, 12, 15, 18]]);\n    })\n  }, {\n    key: \"protectedPlugins\",\n    value: /*#__PURE__*/_regeneratorRuntime.mark(function protectedPlugins() {\n      var _iterator9, _step9, _step9$value, plugin;\n\n      return _regeneratorRuntime.wrap(function protectedPlugins$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _iterator9 = _createForOfIteratorHelper(this._protectedPlugins);\n              _context2.prev = 1;\n\n              _iterator9.s();\n\n            case 3:\n              if ((_step9 = _iterator9.n()).done) {\n                _context2.next = 10;\n                break;\n              }\n\n              _step9$value = _slicedToArray(_step9.value, 2), plugin = _step9$value[1];\n\n              if (!(plugin !== undefined)) {\n                _context2.next = 8;\n                break;\n              }\n\n              _context2.next = 8;\n              return plugin;\n\n            case 8:\n              _context2.next = 3;\n              break;\n\n            case 10:\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](1);\n\n              _iterator9.e(_context2.t0);\n\n            case 15:\n              _context2.prev = 15;\n\n              _iterator9.f();\n\n              return _context2.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, protectedPlugins, this, [[1, 12, 15, 18]]);\n    })\n  }]);\n\n  return FunctionRegistry;\n}();\nFunctionRegistry.plugins = new Map();\nFunctionRegistry._protectedPlugins = new Map([['VERSION', VersionPlugin], ['OFFSET', undefined]]);","map":{"version":3,"sources":["/Users/mingjie.wang/Documents/Uber/MandA/demo-project/node_modules/hyperformula/es/interpreter/FunctionRegistry.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_slicedToArray","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_i","_arr","_n","_d","_s","_e","call","next","done","push","value","length","err","_createForOfIteratorHelper","o","allowArrayLike","it","F","s","n","e","_e2","f","normalCompletion","didErr","step","_e3","return","minLen","Object","prototype","toString","slice","constructor","name","test","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","AliasAlreadyExisting","FunctionPluginValidationError","ProtectedFunctionError","HyperFormula","VersionPlugin","validateAndReturnMetadataFromName","functionId","plugin","_a","entry","implementedFunctions","aliases","undefined","functionNotDeclaredInPlugin","FunctionRegistry","config","_this","functions","Map","arraySizeFunctions","volatileFunctions","Set","arrayFunctions","structuralChangeFunctions","functionsWhichDoesNotNeedArgumentsToBeComputed","functionsMetadata","doesFunctionNeedArgumentToBeComputed","has","isFunctionVolatile","isArrayFunction","isFunctionDependentOnSheetStructureChange","functionPlugins","instancePlugins","_iterator","_step","loadPluginFunctions","plugins","_iterator2","protectedFunctions","_step2","_step2$value","_plugin","loadFunctionUnprotected","_iterator3","entries","_step3","_step3$value","_functionId","_plugin2","categorizeFunction","initializePlugins","interpreter","_this2","instances","_iterator4","_step4","_loop","_step4$value","foundPluginInstance","find","pluginInstance","metadata","methodName","method","set","arraySizeMethodName","arraySizeMethod","getFunctionPlugin","functionIsProtected","get","getFunction","pluginEntry","translationPackage","isFunctionTranslated","_pluginEntry","pluginFunction","ast","state","getArraySizeFunction","_pluginEntry2","pluginArraySizeFunction","getMetadata","getPlugins","_iterator5","_step5","_step5$value","add","getRegisteredFunctionIds","keys","functionMetadata","isVolatile","arrayFunction","doesNotNeedArgumentsToBeComputed","isDependentOnSheetStructureChange","registerFunctionPlugin","translations","loadTranslations","registerFunction","loadPluginFunction","unregisterFunction","cannotUnregisterFunctionWithId","delete","unregisterFunctionPlugin","_iterator6","protectedPlugins","_step6","protectedPlugin","cannotUnregisterProtectedPlugin","_iterator7","_step7","_step7$value","registeredPlugin","unregisterAll","clear","concat","_protectedPlugins","values","registeredLanguages","getRegisteredLanguagesCodes","forEach","code","getLanguage","extendFunctions","registry","_this3","functionName","cannotRegisterFunctionWithId","hasOwnProperty","functionMethodNotFound","mark","_iterator8","_step8","_step8$value","wrap","protectedFunctions$","_context","prev","t0","finish","stop","_iterator9","_step9","_step9$value","protectedPlugins$","_context2"],"mappings":"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","sourcesContent":["import \"regenerator-runtime/runtime.js\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\n/**\n * @license\n * Copyright (c) 2021 Handsoncode. All rights reserved.\n */\nimport { AliasAlreadyExisting, FunctionPluginValidationError, ProtectedFunctionError } from '../errors';\nimport { HyperFormula } from '../HyperFormula';\nimport { VersionPlugin } from './plugin/VersionPlugin';\n\nfunction validateAndReturnMetadataFromName(functionId, plugin) {\n  var _a;\n\n  var entry = plugin.implementedFunctions[functionId];\n  var key = (_a = plugin.aliases) === null || _a === void 0 ? void 0 : _a[functionId];\n\n  if (key !== undefined) {\n    if (entry !== undefined) {\n      throw new AliasAlreadyExisting(functionId, plugin.name);\n    }\n\n    entry = plugin.implementedFunctions[key];\n  }\n\n  if (entry === undefined) {\n    throw FunctionPluginValidationError.functionNotDeclaredInPlugin(functionId, plugin.name);\n  }\n\n  return entry;\n}\n\nexport var FunctionRegistry = /*#__PURE__*/function () {\n  function FunctionRegistry(config) {\n    var _this = this;\n\n    _classCallCheck(this, FunctionRegistry);\n\n    this.config = config;\n    this.functions = new Map();\n    this.arraySizeFunctions = new Map();\n    this.volatileFunctions = new Set();\n    this.arrayFunctions = new Set();\n    this.structuralChangeFunctions = new Set();\n    this.functionsWhichDoesNotNeedArgumentsToBeComputed = new Set();\n    this.functionsMetadata = new Map();\n\n    this.doesFunctionNeedArgumentToBeComputed = function (functionId) {\n      return _this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(functionId);\n    };\n\n    this.isFunctionVolatile = function (functionId) {\n      return _this.volatileFunctions.has(functionId);\n    };\n\n    this.isArrayFunction = function (functionId) {\n      return _this.arrayFunctions.has(functionId);\n    };\n\n    this.isFunctionDependentOnSheetStructureChange = function (functionId) {\n      return _this.structuralChangeFunctions.has(functionId);\n    };\n\n    if (config.functionPlugins.length > 0) {\n      this.instancePlugins = new Map();\n\n      var _iterator = _createForOfIteratorHelper(config.functionPlugins),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var plugin = _step.value;\n          FunctionRegistry.loadPluginFunctions(plugin, this.instancePlugins);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    } else {\n      this.instancePlugins = new Map(FunctionRegistry.plugins);\n    }\n\n    var _iterator2 = _createForOfIteratorHelper(FunctionRegistry.protectedFunctions()),\n        _step2;\n\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var _step2$value = _slicedToArray(_step2.value, 2),\n            functionId = _step2$value[0],\n            _plugin = _step2$value[1];\n\n        FunctionRegistry.loadFunctionUnprotected(_plugin, functionId, this.instancePlugins);\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n\n    var _iterator3 = _createForOfIteratorHelper(this.instancePlugins.entries()),\n        _step3;\n\n    try {\n      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n        var _step3$value = _slicedToArray(_step3.value, 2),\n            _functionId = _step3$value[0],\n            _plugin2 = _step3$value[1];\n\n        this.categorizeFunction(_functionId, validateAndReturnMetadataFromName(_functionId, _plugin2));\n      }\n    } catch (err) {\n      _iterator3.e(err);\n    } finally {\n      _iterator3.f();\n    }\n  }\n\n  _createClass(FunctionRegistry, [{\n    key: \"initializePlugins\",\n    value: function initializePlugins(interpreter) {\n      var _this2 = this;\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      var instances = [];\n\n      var _iterator4 = _createForOfIteratorHelper(this.instancePlugins.entries()),\n          _step4;\n\n      try {\n        var _loop = function _loop() {\n          var _step4$value = _slicedToArray(_step4.value, 2),\n              functionId = _step4$value[0],\n              plugin = _step4$value[1];\n\n          var foundPluginInstance = instances.find(function (pluginInstance) {\n            return pluginInstance instanceof plugin;\n          });\n\n          if (foundPluginInstance === undefined) {\n            foundPluginInstance = new plugin(interpreter);\n            instances.push(foundPluginInstance);\n          }\n\n          var metadata = validateAndReturnMetadataFromName(functionId, plugin);\n          var methodName = metadata.method;\n\n          _this2.functions.set(functionId, [methodName, foundPluginInstance]);\n\n          var arraySizeMethodName = metadata.arraySizeMethod;\n\n          if (arraySizeMethodName !== undefined) {\n            _this2.arraySizeFunctions.set(functionId, [arraySizeMethodName, foundPluginInstance]);\n          }\n        };\n\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          _loop();\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }, {\n    key: \"getFunctionPlugin\",\n    value: function getFunctionPlugin(functionId) {\n      if (FunctionRegistry.functionIsProtected(functionId)) {\n        return undefined;\n      }\n\n      return this.instancePlugins.get(functionId);\n    }\n  }, {\n    key: \"getFunction\",\n    value: function getFunction(functionId) {\n      var pluginEntry = this.functions.get(functionId);\n\n      if (pluginEntry !== undefined && this.config.translationPackage.isFunctionTranslated(functionId)) {\n        var _pluginEntry = _slicedToArray(pluginEntry, 2),\n            pluginFunction = _pluginEntry[0],\n            pluginInstance = _pluginEntry[1];\n\n        return function (ast, state) {\n          return pluginInstance[pluginFunction](ast, state);\n        };\n      } else {\n        return undefined;\n      }\n    }\n  }, {\n    key: \"getArraySizeFunction\",\n    value: function getArraySizeFunction(functionId) {\n      var pluginEntry = this.arraySizeFunctions.get(functionId);\n\n      if (pluginEntry !== undefined && this.config.translationPackage.isFunctionTranslated(functionId)) {\n        var _pluginEntry2 = _slicedToArray(pluginEntry, 2),\n            pluginArraySizeFunction = _pluginEntry2[0],\n            pluginInstance = _pluginEntry2[1];\n\n        return function (ast, state) {\n          return pluginInstance[pluginArraySizeFunction](ast, state);\n        };\n      } else {\n        return undefined;\n      }\n    }\n  }, {\n    key: \"getMetadata\",\n    value: function getMetadata(functionId) {\n      return this.functionsMetadata.get(functionId);\n    }\n  }, {\n    key: \"getPlugins\",\n    value: function getPlugins() {\n      var plugins = new Set();\n\n      var _iterator5 = _createForOfIteratorHelper(this.instancePlugins),\n          _step5;\n\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _step5$value = _slicedToArray(_step5.value, 2),\n              functionId = _step5$value[0],\n              plugin = _step5$value[1];\n\n          if (!FunctionRegistry.functionIsProtected(functionId)) {\n            plugins.add(plugin);\n          }\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n\n      return Array.from(plugins);\n    }\n  }, {\n    key: \"getRegisteredFunctionIds\",\n    value: function getRegisteredFunctionIds() {\n      return Array.from(this.functions.keys());\n    }\n  }, {\n    key: \"categorizeFunction\",\n    value: function categorizeFunction(functionId, functionMetadata) {\n      if (functionMetadata.isVolatile) {\n        this.volatileFunctions.add(functionId);\n      }\n\n      if (functionMetadata.arrayFunction) {\n        this.arrayFunctions.add(functionId);\n      }\n\n      if (functionMetadata.doesNotNeedArgumentsToBeComputed) {\n        this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(functionId);\n      }\n\n      if (functionMetadata.isDependentOnSheetStructureChange) {\n        this.structuralChangeFunctions.add(functionId);\n      }\n\n      this.functionsMetadata.set(functionId, functionMetadata);\n    }\n  }], [{\n    key: \"registerFunctionPlugin\",\n    value: function registerFunctionPlugin(plugin, translations) {\n      this.loadPluginFunctions(plugin, this.plugins);\n\n      if (translations !== undefined) {\n        this.loadTranslations(translations);\n      }\n    }\n  }, {\n    key: \"registerFunction\",\n    value: function registerFunction(functionId, plugin, translations) {\n      this.loadPluginFunction(plugin, functionId, this.plugins);\n\n      if (translations !== undefined) {\n        this.loadTranslations(translations);\n      }\n    }\n  }, {\n    key: \"unregisterFunction\",\n    value: function unregisterFunction(functionId) {\n      if (this.functionIsProtected(functionId)) {\n        throw ProtectedFunctionError.cannotUnregisterFunctionWithId(functionId);\n      }\n\n      this.plugins.delete(functionId);\n    }\n  }, {\n    key: \"unregisterFunctionPlugin\",\n    value: function unregisterFunctionPlugin(plugin) {\n      var _iterator6 = _createForOfIteratorHelper(this.protectedPlugins()),\n          _step6;\n\n      try {\n        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n          var protectedPlugin = _step6.value;\n\n          if (protectedPlugin === plugin) {\n            throw ProtectedFunctionError.cannotUnregisterProtectedPlugin();\n          }\n        }\n      } catch (err) {\n        _iterator6.e(err);\n      } finally {\n        _iterator6.f();\n      }\n\n      var _iterator7 = _createForOfIteratorHelper(this.plugins.entries()),\n          _step7;\n\n      try {\n        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n          var _step7$value = _slicedToArray(_step7.value, 2),\n              functionId = _step7$value[0],\n              registeredPlugin = _step7$value[1];\n\n          if (registeredPlugin === plugin) {\n            this.plugins.delete(functionId);\n          }\n        }\n      } catch (err) {\n        _iterator7.e(err);\n      } finally {\n        _iterator7.f();\n      }\n    }\n  }, {\n    key: \"unregisterAll\",\n    value: function unregisterAll() {\n      this.plugins.clear();\n    }\n  }, {\n    key: \"getRegisteredFunctionIds\",\n    value: function getRegisteredFunctionIds() {\n      return [].concat(_toConsumableArray(Array.from(this.plugins.keys())), _toConsumableArray(Array.from(this._protectedPlugins.keys())));\n    }\n  }, {\n    key: \"getPlugins\",\n    value: function getPlugins() {\n      return Array.from(new Set(this.plugins.values()).values());\n    }\n  }, {\n    key: \"getFunctionPlugin\",\n    value: function getFunctionPlugin(functionId) {\n      if (this.functionIsProtected(functionId)) {\n        return undefined;\n      } else {\n        return this.plugins.get(functionId);\n      }\n    }\n  }, {\n    key: \"loadTranslations\",\n    value: function loadTranslations(translations) {\n      var registeredLanguages = new Set(HyperFormula.getRegisteredLanguagesCodes());\n      Object.keys(translations).forEach(function (code) {\n        if (registeredLanguages.has(code)) {\n          HyperFormula.getLanguage(code).extendFunctions(translations[code]);\n        }\n      });\n    }\n  }, {\n    key: \"loadPluginFunctions\",\n    value: function loadPluginFunctions(plugin, registry) {\n      var _this3 = this;\n\n      Object.keys(plugin.implementedFunctions).forEach(function (functionName) {\n        _this3.loadPluginFunction(plugin, functionName, registry);\n      });\n\n      if (plugin.aliases !== undefined) {\n        Object.keys(plugin.aliases).forEach(function (functionName) {\n          _this3.loadPluginFunction(plugin, functionName, registry);\n        });\n      }\n    }\n  }, {\n    key: \"loadPluginFunction\",\n    value: function loadPluginFunction(plugin, functionId, registry) {\n      if (this.functionIsProtected(functionId)) {\n        throw ProtectedFunctionError.cannotRegisterFunctionWithId(functionId);\n      } else {\n        this.loadFunctionUnprotected(plugin, functionId, registry);\n      }\n    }\n  }, {\n    key: \"loadFunctionUnprotected\",\n    value: function loadFunctionUnprotected(plugin, functionId, registry) {\n      var methodName = validateAndReturnMetadataFromName(functionId, plugin).method;\n\n      if (Object.prototype.hasOwnProperty.call(plugin.prototype, methodName)) {\n        registry.set(functionId, plugin);\n      } else {\n        throw FunctionPluginValidationError.functionMethodNotFound(methodName, plugin.name);\n      }\n    }\n  }, {\n    key: \"functionIsProtected\",\n    value: function functionIsProtected(functionId) {\n      return this._protectedPlugins.has(functionId);\n    }\n  }, {\n    key: \"protectedFunctions\",\n    value: /*#__PURE__*/regeneratorRuntime.mark(function protectedFunctions() {\n      var _iterator8, _step8, _step8$value, functionId, plugin;\n\n      return regeneratorRuntime.wrap(function protectedFunctions$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _iterator8 = _createForOfIteratorHelper(this._protectedPlugins);\n              _context.prev = 1;\n\n              _iterator8.s();\n\n            case 3:\n              if ((_step8 = _iterator8.n()).done) {\n                _context.next = 10;\n                break;\n              }\n\n              _step8$value = _slicedToArray(_step8.value, 2), functionId = _step8$value[0], plugin = _step8$value[1];\n\n              if (!(plugin !== undefined)) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 8;\n              return [functionId, plugin];\n\n            case 8:\n              _context.next = 3;\n              break;\n\n            case 10:\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](1);\n\n              _iterator8.e(_context.t0);\n\n            case 15:\n              _context.prev = 15;\n\n              _iterator8.f();\n\n              return _context.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, protectedFunctions, this, [[1, 12, 15, 18]]);\n    })\n  }, {\n    key: \"protectedPlugins\",\n    value: /*#__PURE__*/regeneratorRuntime.mark(function protectedPlugins() {\n      var _iterator9, _step9, _step9$value, plugin;\n\n      return regeneratorRuntime.wrap(function protectedPlugins$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _iterator9 = _createForOfIteratorHelper(this._protectedPlugins);\n              _context2.prev = 1;\n\n              _iterator9.s();\n\n            case 3:\n              if ((_step9 = _iterator9.n()).done) {\n                _context2.next = 10;\n                break;\n              }\n\n              _step9$value = _slicedToArray(_step9.value, 2), plugin = _step9$value[1];\n\n              if (!(plugin !== undefined)) {\n                _context2.next = 8;\n                break;\n              }\n\n              _context2.next = 8;\n              return plugin;\n\n            case 8:\n              _context2.next = 3;\n              break;\n\n            case 10:\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](1);\n\n              _iterator9.e(_context2.t0);\n\n            case 15:\n              _context2.prev = 15;\n\n              _iterator9.f();\n\n              return _context2.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, protectedPlugins, this, [[1, 12, 15, 18]]);\n    })\n  }]);\n\n  return FunctionRegistry;\n}();\nFunctionRegistry.plugins = new Map();\nFunctionRegistry._protectedPlugins = new Map([['VERSION', VersionPlugin], ['OFFSET', undefined]]);"]},"metadata":{},"sourceType":"module"}